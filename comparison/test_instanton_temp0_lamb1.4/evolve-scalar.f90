!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! BUBBLE CORRELATIONS
#include "macros.h"
#define SMOOTH 1

program Gross_Pitaevskii_1d
  use, intrinsic :: iso_c_binding
  use gaussianRandomField
  use integrator
  use constants
  use eom
  implicit none

  !> Initialise fluctuations in linear perturbation theory approximation
  !> type : (1) sets vacuum
  !>        (2) thermal+vacuum
  !>        (3) only thermal
  real(dl), parameter :: phi0 = twopi / 2.8_dl
  real(dl), parameter :: temp = 0.
  integer, parameter :: type = 1

  integer :: nTimeMax = nLat
  integer :: sim
  integer :: lSim = 0, nSim = 1

!  integer :: ss
!  integer, dimension(500) :: simList = (/ /)


  real(dl), pointer :: time
  real(dl), dimension(:,:), pointer :: fld
  type(transformPair1D) :: tPairgsq

  fld(1:nLat,1:2) => yvec(1:nVar-1) ! store the field in yvec
  time => yvec(nVar) ! last position stores the time?
  call initialize_rand(93286123,12)
  call setup(nVar)

  do sim = 0, nSim-1
      call initialise_fields(fld, lenLat, m2eff, temp, type, phi0, nyq)
      if (sim >= lSim) then
 !         if (ANY(simList==sim)) then
          call time_evolve(sim, temp, alph)
          print*, "Simulation ", sim, " out of ", nSim , " done!"
 !         endif
      endif
  end do
  print*, "All Done!"

contains

  subroutine initialise_fields(fld, len, m2, temp, type, phi0, klat)
    real(dl), dimension(:,:), intent(inout) :: fld
    real(dl), intent(in) :: len, m2, temp
    integer, intent(in) :: type
    integer, intent(in), optional :: klat
    real(dl), intent(in), optional :: phi0

    fld(:,1)   = twopi/2._dl

! this is the instanton solution
!    fld(:, 1) = fld(:,1) + (/0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.003028202222548959, -0.0027795987922920595, -0.0025514385131435446, -0.0023420173892922946, -0.0021498001976616443, -0.001973382494981024, -0.0018114459734013266, -0.0016628147329291743, -0.001526398948576535, -0.0014011886964713227, -0.0012862634701940046, -0.001180780658730729, -0.001083957325241247, -0.0009950722250833266, -0.0009134583644336836, -0.0008386027409188479, -0.0007697883767501246, -0.0007066678348288669, -0.0006487416263567525, -0.0005955545397653417, -0.0005467463250226068, -0.0005019352709938474, -0.00046080461362674185, -0.0004230468565693535, -0.00038837022278315203, -0.00035655061866313176, -0.00032734242492749033, -0.0003005191938401097, -0.00027590719526759955, -0.00025331309858644957, -0.00023256683346906115, -0.0002135309298614274, -0.00019604384658311602, -0.0001799784566114404, -0.00016523619029706893, -0.00015171547504611027, -0.00013929170285953418, -0.00012788169966304608, -0.000117413860155402, -0.00010781037761020684, -9.898514197104191e-05, -9.08828595953537e-05, -8.345079552363188e-05, -7.66251033148535e-05, -7.034759603374852e-05, -6.458280424981311e-05, -5.929541158433693e-05, -5.4448845228538545e-05, -4.999399561356199e-05, -4.5900196307790964e-05, -4.2142941241607446e-05, -3.869772434761387e-05, -3.553433353298274e-05, -3.261937048604224e-05, -2.9937553635228653e-05, -2.747434372629698e-05, -2.5215201504558138e-05, -2.3145587715323046e-05, -2.1245540801739793e-05, -1.9494379296602915e-05, -1.788298443017311e-05, -1.6402420881078683e-05, -1.5043753329724296e-05, -1.3798046456070523e-05, -1.2653223905090272e-05, -1.1598278813362839e-05, -1.0626886644438116e-05, -9.732730709366422e-06, -8.909494320086253e-06, -8.150851701138606e-06, -7.447819229788877e-06, -6.793249054837247e-06, -6.201510356795836e-06, -5.646404488857115e-06, -5.133471705054404e-06, -4.6564694327067e-06, -4.2132064632660615e-06, -3.8015269852031963e-06, -3.418440325919647e-06, -3.063927200397387e-06, -2.7379876090805055e-06, -2.394250722126401e-06, -2.0904929964871144e-06, -1.8009253861528407e-06, -1.5236070445290295e-06, -1.2565971263533982e-06, -9.97957224413426e-07, -7.457737551952448e-07, -4.980977541535481e-07, -2.529682383567433e-07, -8.424226649594857e-09, 2.3747710464760985e-07, 4.866229765809749e-07, 7.410160836052171e-07, 1.0026753898273455e-06, 1.273619859354369e-06, 1.556119737067263e-06, 1.8526196279289309e-06, 2.164745412702729e-06, 2.494086024817932e-06, 2.8484861664956895e-06, 3.224627592501861e-06, 3.6281054907050247e-06, 4.061948088995848e-06, 4.529613067294491e-06, 5.035070375303263e-06, 5.5836337669035174e-06, 6.1795646599804854e-06, 6.82725650458238e-06, 7.53179990153896e-06, 8.299402742828477e-06, 9.137750665022537e-06, 1.0052904924506834e-05, 1.1051731616085192e-05, 1.2142177614915539e-05, 1.3333233752188534e-05, 1.4634984357275727e-05, 1.6058672068108848e-05, 1.7616605271886243e-05, 1.932214543831634e-05, 2.1189158013523723e-05, 2.3233276438272554e-05, 2.547156806675943e-05, 2.7924432496995166e-05, 3.0610343332071466e-05, 3.355292970930179e-05, 3.6777158106460206e-05, 4.030958707401666e-05, 4.418019499574655e-05, 4.8422371069278825e-05, 5.307202641624542e-05, 5.816768354005575e-05, 6.375333060448796e-05, 6.987679517811429e-05, 7.65892606446883e-05, 8.394745975781603e-05, 9.201490977739368e-05, 0.00010086028046485396, 0.00011055675296134382, 0.00012118869894006679, 0.0001328483146889603, 0.00014563461445371573, 0.00015965603595846645, 0.00017503409445218665, 0.00019190036690286405, 0.00021039816171031234, 0.00023068819621130388, 0.0002529451295880669, 0.00027735772812453874, 0.0003041393277549709, 0.0003335225863305702, 0.0003657578453299948, 0.0004011262175414032, 0.0004399361291365089, 0.0004825198106757078, 0.000529247910309838, 0.0005805303136998674, 0.0006368091839985546, 0.0006985736566584855, 0.0007663704451861264, 0.0008407926140625577, 0.0009224887151972894, 0.0010121771767557242, 0.0011106434287304623, 0.0012187567369408292, 0.0013374681361004725, 0.001467826270869832, 0.001610984461809295, 0.0017682081147958328, 0.0019408966864546962, 0.0021305822438995037, 0.00233895644544857, 0.0025678802030228987, 0.0028193984857085574, 0.0030957626412067007, 0.003399454598779883, 0.0037332057499330773, 0.004100024893619825, 0.004503225868145222, 0.00494646001976351, 0.005433748981018116, 0.005969526255952928, 0.006558676348851211, 0.007206586195484199, 0.007919195408432778, 0.008703053467346678, 0.009565379657505702, 0.01051414400916384, 0.011558141090341145, 0.012707078765529012, 0.013971668151957495, 0.015363742091388133, 0.01689633676373825, 0.018583887190273707, 0.020442346386048804, 0.022489325295507623, 0.024744293375194015, 0.027228782611895763, 0.02996660138044538, 0.03298408347790538, 0.03631037342991528, 0.039977720183429266, 0.0440218167488009, 0.04848219664364661, 0.05340262717144073, 0.05883158500207353, 0.06482277094146704, 0.07143568218207852, 0.07873622985568618, 0.08679743137375961, 0.09570017400300745, 0.10553403399137729, 0.11639817281157905, 0.12840230415743337, 0.14166772071646516, 0.15632837192103466, 0.17253197374941154, 0.19044111875994396, 0.210234339162799, 0.2321070557325844, 0.2562723137545033, 0.28296116306807395, 0.3124225170863917, 0.344922241394213, 0.3807411438893862, 0.42017149074046367, 0.4635115657818325, 0.5110577236712945, 0.56309338710739, 0.619874333371031, 0.6816100560165532, 0.7484410267541808, 0.82041244697814, 0.8974458234702727, 0.9793111255916642, 1.0656027203697498, 1.1557239653825153, 1.2488850216978005, 1.3441177216106892, 1.4403090997196122, 1.5362517939537295, 1.6307062021172722, 1.7224659333158545, 1.8104183822787432, 1.8935918816526556, 1.9711851432707146, 2.0425775065306713, 2.1073218480954026, 2.1651242651928815, 2.215814744132751, 2.2593126877111827, 2.2955888887369875, 2.3246214150594424, 2.3463314956024224, 2.3604397298202437, 2.3658645189102065, 2.3604397298202437, 2.3463314956024224, 2.3246214150594424, 2.2955888887369875, 2.2593126877111827, 2.215814744132751, 2.1651242651928815, 2.1073218480954026, 2.0425775065306713, 1.9711851432707146, 1.8935918816526556, 1.8104183822787432, 1.7224659333158545, 1.6307062021172722, 1.5362517939537295, 1.4403090997196122, 1.3441177216106892, 1.2488850216978005, 1.1557239653825153, 1.0656027203697498, 0.9793111255916642, 0.8974458234702727, 0.82041244697814, 0.7484410267541808, 0.6816100560165532, 0.619874333371031, 0.56309338710739, 0.5110577236712945, 0.4635115657818325, 0.42017149074046367, 0.3807411438893862, 0.344922241394213, 0.3124225170863917, 0.28296116306807395, 0.2562723137545033, 0.2321070557325844, 0.210234339162799, 0.19044111875994396, 0.17253197374941154, 0.15632837192103466, 0.14166772071646516, 0.12840230415743337, 0.11639817281157905, 0.10553403399137729, 0.09570017400300745, 0.08679743137375961, 0.07873622985568618, 0.07143568218207852, 0.06482277094146704, 0.05883158500207353, 0.05340262717144073, 0.04848219664364661, 0.0440218167488009, 0.039977720183429266, 0.03631037342991528, 0.03298408347790538, 0.02996660138044538, 0.027228782611895763, 0.024744293375194015, 0.022489325295507623, 0.020442346386048804, 0.018583887190273707, 0.01689633676373825, 0.015363742091388133, 0.013971668151957495, 0.012707078765529012, 0.011558141090341145, 0.01051414400916384, 0.009565379657505702, 0.008703053467346678, 0.007919195408432778, 0.007206586195484199, 0.006558676348851211, 0.005969526255952928, 0.005433748981018116, 0.00494646001976351, 0.004503225868145222, 0.004100024893619825, 0.0037332057499330773, 0.003399454598779883, 0.0030957626412067007, 0.0028193984857085574, 0.0025678802030228987, 0.00233895644544857, 0.0021305822438995037, 0.0019408966864546962, 0.0017682081147958328, 0.001610984461809295, 0.001467826270869832, 0.0013374681361004725, 0.0012187567369408292, 0.0011106434287304623, 0.0010121771767557242, 0.0009224887151972894, 0.0008407926140625577, 0.0007663704451861264, 0.0006985736566584855, 0.0006368091839985546, 0.0005805303136998674, 0.000529247910309838, 0.0004825198106757078, 0.0004399361291365089, 0.0004011262175414032, 0.0003657578453299948, 0.0003335225863305702, 0.0003041393277549709, 0.00027735772812453874, 0.0002529451295880669, 0.00023068819621130388, 0.00021039816171031234, 0.00019190036690286405, 0.00017503409445218665, 0.00015965603595846645, 0.00014563461445371573, 0.0001328483146889603, 0.00012118869894006679, 0.00011055675296134382, 0.00010086028046485396, 9.201490977739368e-05, 8.394745975781603e-05, 7.65892606446883e-05, 6.987679517811429e-05, 6.375333060448796e-05, 5.816768354005575e-05, 5.307202641624542e-05, 4.8422371069278825e-05, 4.418019499574655e-05, 4.030958707401666e-05, 3.6777158106460206e-05, 3.355292970930179e-05, 3.0610343332071466e-05, 2.7924432496995166e-05, 2.547156806675943e-05, 2.3233276438272554e-05, 2.1189158013523723e-05, 1.932214543831634e-05, 1.7616605271886243e-05, 1.6058672068108848e-05, 1.4634984357275727e-05, 1.3333233752188534e-05, 1.2142177614915539e-05, 1.1051731616085192e-05, 1.0052904924506834e-05, 9.137750665022537e-06, 8.299402742828477e-06, 7.53179990153896e-06, 6.82725650458238e-06, 6.1795646599804854e-06, 5.5836337669035174e-06, 5.035070375303263e-06, 4.529613067294491e-06, 4.061948088995848e-06, 3.6281054907050247e-06, 3.224627592501861e-06, 2.8484861664956895e-06, 2.494086024817932e-06, 2.164745412702729e-06, 1.8526196279289309e-06, 1.556119737067263e-06, 1.273619859354369e-06, 1.0026753898273455e-06, 7.410160836052171e-07, 4.866229765809749e-07, 2.3747710464760985e-07, -8.424226649594857e-09, -2.529682383567433e-07, -4.980977541535481e-07, -7.457737551952448e-07, -9.97957224413426e-07, -1.2565971263533982e-06, -1.5236070445290295e-06, -1.8009253861528407e-06, -2.0904929964871144e-06, -2.394250722126401e-06, -2.7379876090805055e-06, -3.063927200397387e-06, -3.418440325919647e-06, -3.8015269852031963e-06, -4.2132064632660615e-06, -4.6564694327067e-06, -5.133471705054404e-06, -5.646404488857115e-06, -6.201510356795836e-06, -6.793249054837247e-06, -7.447819229788877e-06, -8.150851701138606e-06, -8.909494320086253e-06, -9.732730709366422e-06, -1.0626886644438116e-05, -1.1598278813362839e-05, -1.2653223905090272e-05, -1.3798046456070523e-05, -1.5043753329724296e-05, -1.6402420881078683e-05, -1.788298443017311e-05, -1.9494379296602915e-05, -2.1245540801739793e-05, -2.3145587715323046e-05, -2.5215201504558138e-05, -2.747434372629698e-05, -2.9937553635228653e-05, -3.261937048604224e-05, -3.553433353298274e-05, -3.869772434761387e-05, -4.2142941241607446e-05, -4.5900196307790964e-05, -4.999399561356199e-05, -5.4448845228538545e-05, -5.929541158433693e-05, -6.458280424981311e-05, -7.034759603374852e-05, -7.66251033148535e-05, -8.345079552363188e-05, -9.08828595953537e-05, -9.898514197104191e-05, -0.00010781037761020684, -0.000117413860155402, -0.00012788169966304608, -0.00013929170285953418, -0.00015171547504611027, -0.00016523619029706893, -0.0001799784566114404, -0.00019604384658311602, -0.0002135309298614274, -0.00023256683346906115, -0.00025331309858644957, -0.00027590719526759955, -0.0003005191938401097, -0.00032734242492749033, -0.00035655061866313176, -0.00038837022278315203, -0.0004230468565693535, -0.00046080461362674185, -0.0005019352709938474, -0.0005467463250226068, -0.0005955545397653417, -0.0006487416263567525, -0.0007066678348288669, -0.0007697883767501246, -0.0008386027409188479, -0.0009134583644336836, -0.0009950722250833266, -0.001083957325241247, -0.001180780658730729, -0.0012862634701940046, -0.0014011886964713227, -0.001526398948576535, -0.0016628147329291743, -0.0018114459734013266, -0.001973382494981024, -0.0021498001976616443, -0.0023420173892922946, -0.0025514385131435446, -0.0027795987922920595, -0.003028202222548959, -0.0032990508765524673, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0/)
    
! critical slice
    fld(:,1)   = fld(:,1) + (/0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.00043363425257059163, -0.0063696272817446165, -0.005250636589179347, -0.00401427496040796, -0.006017753066463349, 0.007897192351519422, 0.007709654398740717, -0.004184221790239473, -0.0032122112351768983, 0.0010302095659233679, 0.010167203440852646, 0.020157527981114143, 0.008727209596876229, 0.0032066427736783254, 0.009411626097193704, 0.012213015185025267, 0.004941150937027405, 0.006366804269060999, 0.0003506586198374073, 0.0005882527998912757, -0.002198351343421834, 0.0014547134336533318, -0.004914187712009799, -0.006495002640727776, -0.00411497354279744, 0.005118732064534726, 0.00813868671432072, 0.021463601886253514, 0.015697137476729406, 0.011106943587181117, -0.005019470496738787, -0.006172565571849642, -0.0026266661535276903, 0.011953901951189838, 0.005391774367891511, 0.02314474618724427, 0.00705822521091326, 0.016507035243949808, 0.011170185475779082, 0.01195040018688509, 0.012882504115606874, 0.01533174635817236, 0.011407775674883158, -0.0036756406775406703, -0.003490393168474437, 0.011718063173205895, 0.013636693789536913, 0.008833301482619405, 0.020937535753661862, 0.02122128910896448, 0.016800384749398045, 0.016290226147284592, 0.010270286763702785, 0.016906457319244783, 0.009072803992155709, 0.021151181518946682, 0.028881053474377527, 0.026964718150646494, 0.03518978409640505, 0.02635642171164987, 0.02814229458781803, 0.03369434518582315, 0.028058511915803663, 0.03736267086913925, 0.05103760796776324, 0.041690379975916514, 0.03548724009887394, 0.03675390343295648, 0.028710040166974427, 0.032083823197244676, 0.03283196882126482, 0.0452440824005822, 0.036682711010097346, 0.041190015812192726, 0.04009142338977645, 0.04863881154915939, 0.041486971031507114, 0.03193575109695912, 0.029040705592487726, 0.03676607183452951, 0.04228287714122514, 0.04407191306233349, 0.046595130059783774, 0.04754529370248095, 0.052112237469180034, 0.06396232281717085, 0.06326748784811587, 0.07784839745683403, 0.07962022258890755, 0.07415853685979323, 0.07822546239781092, 0.08733304020382393, 0.0962706515206242, 0.09034745225725827, 0.09183114704697015, 0.10279099426877103, 0.10217079489758296, 0.12170272171811725, 0.14251434609184965, 0.14836961167044738, 0.15645327482777827, 0.1544696479922547, 0.1635609287815054, 0.1668425273240679, 0.1853647117733921, 0.20066578077242525, 0.21481460383796724, 0.23059436243619702, 0.24917156302401322, 0.26483853465027174, 0.26899516554941627, 0.29862931299094786, 0.32961152018792506, 0.35749069009739953, 0.38989949171295724, 0.41776786347979744, 0.4419528938858388, 0.45996121749241237, 0.4941008496899757, 0.5154838561949258, 0.5422439141624538, 0.5745977456083495, 0.6022676045287363, 0.6485612598173751, 0.6774570911032263, 0.7142012263169022, 0.7418898634165334, 0.7843866967093152, 0.8199447447638955, 0.8595127857415497, 0.9029492217351116, 0.9452301742552676, 0.9913091284364235, 1.036653822062613, 1.0790494859423534, 1.1246354753519103, 1.182428962770671, 1.2322228100113275, 1.2686640182187343, 1.2982712279907016, 1.3449254543592328, 1.3886012314863923, 1.440112318081888, 1.4598349343230241, 1.46600627949873, 1.458522011677152, 1.4580541450089717, 1.4623144487619815, 1.4820143428449066, 1.4756938884238293, 1.4597869674391442, 1.460025575274627, 1.4454550604566272, 1.4395452318242787, 1.4496033722345842, 1.445940616685795, 1.454566953945334, 1.4596452182531179, 1.4437034803734825, 1.4193416403385672, 1.3767901842006172, 1.3440930999120457, 1.316274059647256, 1.2712170047845017, 1.2209463391610687, 1.1791045756758, 1.137460128212001, 1.0875439601092802, 1.0449603091989346, 0.9726401498655708, 0.9478098187062578, 0.9042149780668316, 0.8644718603994992, 0.8307427844188515, 0.7820425793539063, 0.7390425982637061, 0.714108773105631, 0.6819754583861148, 0.6582510859765622, 0.6165180268929422, 0.577391260262115, 0.541290670780338, 0.518681235819693, 0.4921269418142513, 0.48475276533239997, 0.46379304234698937, 0.4134778614139365, 0.38378782053577787, 0.3598142324002649, 0.3439176708224432, 0.3249210135868137, 0.29833784633232874, 0.2805483843894834, 0.26128220849691086, 0.24325930472183233, 0.22429224003542192, 0.2084003308152691, 0.19447990263912684, 0.1998506982774506, 0.19137796586515288, 0.16548271607580212, 0.16243094289117366, 0.1534715903574395, 0.15199105121768275, 0.13449080580244877, 0.1363163461343282, 0.13850342094355783, 0.13053019472246508, 0.11332507013894766, 0.11461158813828431, 0.10609415664516897, 0.10289157694775009, 0.09894803397929852, 0.08889790575072887, 0.09914893139963343, 0.08808315885862283, 0.07739156129233615, 0.07314126652366859, 0.06988011869587174, 0.0773168976223273, 0.0663634602252472, 0.056852658830550684, 0.050813931822338176, 0.05781300671414247, 0.046810193240042874, 0.04159098304231845, 0.04614089647244679, 0.057426467211296295, 0.05146667993229137, 0.03940792372001933, 0.039865471198325064, 0.02615554768300754, 0.04027247471032558, 0.04885365909735384, 0.04381227242410901, 0.03934135323556376, 0.02786958218478386, 0.031247903721355108, 0.018738921028913946, 0.01174219320612746, 0.030790905234621135, 0.015527526519895751, 0.008726614751799477, 0.001806168983997214, 0.02212793544242242, 0.01368104401027237, 0.021893849889760286, 0.010963004435064594, 0.01208382497139171, 0.021504964649849523, 0.02246133339244416, 0.019903150310807582, 0.013960496652620336, 0.008723008875039184, 0.005894400055513227, 0.009886605252082958, 0.014116292592725621, 0.00362624947927781, 0.010224736824421043, 0.008616023822775709, 0.009241784844210343, 0.012749464074222505, 0.01705051592265816, 0.01563802584213514, 0.010276556922279134, 0.0032382279316420792, 0.013304596520053114, 0.0030821488611816328, -0.013613289764094816, -0.013061074129999017, -0.0133240106961372, -0.010738243442346196, -0.0056283883147272284, 0.005545473838691528, 0.002952054594576925, -0.0022134910958211407, -0.018071344819525326, -0.00513707792084217, 0.0015898202407509388, 0.009453824836382019, 0.0007595847239283415, -0.011449213357343169, -0.003918472827913799, 0.0067961611748867945, 0.006025736239087198, -0.0043127996788872025, -0.003692930266436356, -0.014946614891076848, -0.0027326816469050996, -0.008096315156814082, -0.0033593917743348634, 0.003500492195975813, 0.011753700945420498, 0.01802776631656533, 0.0025640393264829697, 0.004162095388790199, -0.0024634601055675276, -0.01576198169042753, -0.0184885877386205, -0.00750253470113682, -0.013494241971856447, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0/)
    
    
! this is tcrit +6 sub-critical slice:
!    fld(:,1) = fld(:,1) + (/0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.002408498080633148, 0.005456440248877925, -0.007412021203489161, -0.017011229309757514, 0.002847572786758512, 0.010624525459367984, 0.011940275565819558, -0.0009507971001077031, -0.012115647733374146, -0.00383466352360351, 0.01621567064670737, 0.017036251267795954, 0.008352497761536348, 0.010786372659858934, 0.007046311253831927, 0.006686887190862745, 0.009029711589575662, 0.009297253393122151, 0.014617820707285123, -0.006885311797063309, -0.009940637444338485, -0.002392737156972302, 0.001351725493214051, -0.011444815180758905, -0.0011095047082609888, 0.00933564719055413, 0.013008616590807875, 0.007590497063338919, 0.013852752434527993, 0.002672758116886609, 0.004962862170546423, 0.001605967025435806, -0.003462930790604002, 0.0053496620076476376, 0.01624251026970258, 0.005011414915403911, 0.02000621882224829, 0.005216231667363402, 0.021818695888874196, 0.016685390454540094, 0.01340805148518287, 0.01337528756868478, 0.007129868156705577, 2.6129111643680147e-05, 0.0011382764095979603, 0.003031405327653669, 0.011015476741149222, 0.015602830406661994, 0.00997562237013394, 0.018080783370831632, 0.024917554482362547, 0.009520336261016116, 0.01809619212518898, 0.014859913091011201, 0.01963184188334921, 0.02064285472044114, 0.023128933776918714, 0.0361341626498044, 0.030146217690984578, 0.03026952746774958, 0.026886272064004846, 0.022125830474924335, 0.03912865841597446, 0.042611648356833065, 0.03867240837142161, 0.0388948908448139, 0.03523952971617206, 0.038036848691703984, 0.04302351326789733, 0.03401653326313481, 0.036511425757213, 0.032943072141787155, 0.04123804253975738, 0.037189882051975154, 0.0394811135688502, 0.03658882832611221, 0.03355540156235115, 0.03369620338039914, 0.045220122390297934, 0.04923131121545943, 0.041578778404970596, 0.0417021548896912, 0.05009814420371006, 0.05276873073731858, 0.05648056564030268, 0.05778687886837597, 0.06638952034939782, 0.06889580235963422, 0.07281008315683479, 0.07587160607750487, 0.08747437012607451, 0.08854703107693629, 0.08857358119955316, 0.09452684269777079, 0.09148008904695226, 0.09584621690164052, 0.1163830544676161, 0.12065960745064563, 0.1334206383930221, 0.14331562247536045, 0.14860164486927907, 0.165036997806832, 0.1725009260020567, 0.17634416570914713, 0.17729503143658087, 0.18877779380867654, 0.20841704632181335, 0.23191952408305294, 0.24223732490933347, 0.2504075173797373, 0.279068400513236, 0.3034553169617231, 0.33044725135340025, 0.3572851879505068, 0.397410343107929, 0.417675604233247, 0.42901776890383525, 0.4586915628845287, 0.48156576879640056, 0.5090167695256529, 0.5311549386547734, 0.5612332105979063, 0.6021254625339472, 0.6291623429643458, 0.6673273812003577, 0.6899102142501219, 0.7306577287252423, 0.7749975619857454, 0.8148158269570756, 0.8570173485896424, 0.8920982268472644, 0.9225957234653732, 0.9739609021630526, 1.0175681817735818, 1.0683497515903122, 1.11972596764888, 1.1585292546761474, 1.2070464613272112, 1.2561716886705776, 1.2977797906638893, 1.32229192991886, 1.3728901646440885, 1.4129639823195426, 1.4246007587475722, 1.4242013344729774, 1.428344058750012, 1.4328811366378291, 1.4523724972628012, 1.4539052355615825, 1.4615637184226724, 1.4572713943212658, 1.4456688506691293, 1.4432301256346944, 1.4351218028472452, 1.4231297215106684, 1.4248803886938397, 1.4153785418016236, 1.414090039023284, 1.4156779055008126, 1.388293088737786, 1.3770613322159972, 1.34727365671284, 1.2995922353533533, 1.256732432475114, 1.2078869556669325, 1.164176687741799, 1.1199697434579816, 1.079511409425483, 1.0231228680469826, 0.978956906347479, 0.9227805613942808, 0.8950251991549969, 0.8475897620749393, 0.8108897860895836, 0.7857914189169652, 0.7409581392455857, 0.6937190680361796, 0.6668343927472677, 0.6376767077780436, 0.6149372633640122, 0.5693116624908239, 0.5339582191674359, 0.5073629105572031, 0.4872487886537149, 0.4660454850375024, 0.4487358893566342, 0.4309234143396137, 0.3912769837504677, 0.36396043972859893, 0.33990144184778304, 0.32933263976622484, 0.30471412111682517, 0.2777296433511611, 0.26670122566751564, 0.23888241108461417, 0.216236522877999, 0.21105039863813158, 0.1973079988224029, 0.18798603938617253, 0.18101937782642397, 0.18100048355913145, 0.15293821899277127, 0.144879319680165, 0.14863806349869346, 0.14615858221852696, 0.13860518117851983, 0.13332932527884855, 0.12414853168736162, 0.1255196594483574, 0.11528420987309307, 0.11414203875993545, 0.10295606111304334, 0.09871983484082181, 0.10212497513665841, 0.08853328975761166, 0.09445533786465576, 0.08098867134856258, 0.07653842882045314, 0.08427727449412803, 0.07385474580695339, 0.07289727723413453, 0.05751428810324155, 0.046221958493844806, 0.043938428274707064, 0.05946333171998397, 0.05574936920498619, 0.04557496541215045, 0.03876254312073568, 0.04773989031966597, 0.050769234927337425, 0.029714073552263187, 0.046557349121115976, 0.04226979696235622, 0.036014630843160145, 0.03685723043900646, 0.03295363909944138, 0.03615154230595152, 0.03398220385689221, 0.027004371020984408, 0.026649866465992655, 0.013157676996351508, 0.01789511392118781, 0.0078256624877997, 0.019749378389618766, 0.009504954784315345, 0.014192331167028893, 0.006693153121080986, 0.009987968759491483, 0.017780920468319028, 0.02243899263330862, 0.023015893593500536, 0.023575373379285836, 0.008234848021104302, 0.006487064857469971, 0.014664197404645751, 0.010087759770443405, 0.009150357249269714, 0.021050880427196272, 0.012796053161186816, 0.008275090836077581, 0.0069292858430403115, 0.012418543230316992, 0.012054522869610285, 0.009970958712386402, 0.010130000623409963, 0.017867935092332754, 0.009494126879211695, 0.0028772171781845657, -0.004902185113254021, -0.013257977793180054, -0.022493900238659936, -0.01500290357397116, -0.002253560430187651, 0.004134381324424563, 0.0016002778884955937, -0.0094946184989948, -0.0010811449435221832, -0.005771747591055476, 0.011388658859042167, 0.0015417485626478822, -0.006868481146527827, -0.0087983962153797, -0.009809935285454596, 0.001961192724838856, 0.001071722864834701, 0.00044636429298572367, -0.008038256973454061, -0.001644966001548731, -0.017676566747883538, -0.0057675600300650665, -0.00225114476442112, 0.014592539969718654, 0.015710129019502084, 0.002552470511449023, 0.009872874350062233, 0.004684980913082004, -0.005095693249137945, -0.012397831273568638, -0.008453061006034712, -0.017540669702542644, -0.018253219567081036, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0/)
    
    

    fld(:,2)   = 0
    yvec(nVar) = 0 ! Add a tcur pointer here

 !   call initialize_linear_fluctuations(fld, len, m2, temp, type, phi0, klat)
  end subroutine initialise_fields

  subroutine time_evolve(sim, temp, alp) 
    real(dl) :: temp
    real(dl) :: dt
    real(dl) :: dtout
    real(dl) :: sum_cos_fld
    real(dl) :: alp
    integer :: i, j, k, m
    integer :: sim
    logical :: bool

    dt = dx / alp
!    if (dt > dx) print*, "Warning, violating Courant condition"
    dtout = dt * alp

    call output_fields(fld, dtout, sim, temp)

    i = 1
    k = 1
    bool = .True.

    do while ( i <= nLat/2. )
       do j = 1, int(alp)
          call gl10(yvec, dt)
       end do
       call output_fields(fld, dtout, sim, temp)

       if ( bool ) then
          sum_cos_fld = 0._dl
          do m = 1, nLat
             sum_cos_fld = sum_cos_fld + cos(fld(m,1))
          end do
          sum_cos_fld = sum_cos_fld/nLat
          if ( sum_cos_fld > -0.8_dl ) then
             bool = .False.
          end if

          k = k + 1
          if ( k == nTimeMax) then
             exit
          end if
       else

          i = i + 1
       end if
    end do
  end subroutine time_evolve

  subroutine initialize_linear_fluctuations(fld,len,m2,temp,type,phi0,klat)
    real(dl), dimension(:,:), intent(inout) :: fld
    real(dl), intent(in) :: len, m2, temp
    real(dl), intent(in), optional :: phi0
    integer, intent(in), optional :: klat
    integer, intent(in) :: type

    real(dl), dimension(1:size(fld(:,1))) :: df
    real(dl), dimension(1:size(fld(:,1))/2+1) :: spec, w2eff
    real(dl) :: phiL, norm
    integer :: i, j
    integer :: nn
    integer :: kc

    nn = size(spec)
    kc = size(spec); if (present(klat)) kc = klat
    phiL = twopi; if (present(phi0)) phiL = phi0

    ! Normalise assuming the Box-Mueller transform gives a complex
    ! random deviate with unit variance
    norm = 1._dl / phiL / sqrt(2._dl * len)  

    spec(:) = 0._dl
    do i = 1, nn
       w2eff(i) = m2 + (dk*(i-1))**2._dl
    enddo

    select case (type)
       case (1)  ! Vacuum fluctuations
          spec(2:kc) = norm / w2eff(2:kc)**0.25
!       case (2)  ! Thermal + Vacuum
!          spec(2:kc) = norm / w2eff(2:kc)**0.25 * sqrt(2._dl/(exp(w2eff(2:kc)**0.5/temp)-1._dl)+1._dl)
       case (3)  ! Only Thermal
          spec(2:kc) = norm / w2eff(2:kc)**0.25 * sqrt(2._dl/(exp(w2eff(2:kc)**0.5/temp)-1._dl))
    end select

    df(:) = 0._dl
    call generate_1dGRF(df, spec(1:nn))  ! check if this is correct
    fld(:,1) = fld(:,1) + df(:)

    do j = 2, nn
        spec(j) = spec(j)*(w2eff(j)**0.5)
    enddo

    df(:) = 0._dl
    call generate_1dGRF(df, spec(1:nn))
    fld(:,2) = fld(:,2) + df(:)
  end subroutine initialize_linear_fluctuations

  subroutine setup(nVar)
    integer, intent(in) :: nVar
    call init_integrator(nVar)
    call initialize_transform_1d(tPair,nLat)
    call initialize_transform_1d(tPairgsq,nLat)
  end subroutine setup

  character(len=20) function str(k)
    integer, intent(in) :: k
    write (str, *) k
    str = adjustl(str)
  end function str

  character(len=20) function real_str(k)
    real(dl), intent(in) :: k
    write (real_str, '(f12.4)') k
    real_str = adjustl(real_str)
  end function real_str

  subroutine output_fields(fld, dtout, sim, temp)
    real(dl), dimension(1:nLat, 1:2) :: fld
    real(dl), dimension(1:nLat) :: grad
!    real(dl), dimension(1:nLat) :: kinetic
!    real(dl), dimension(1:nLat) :: gradient
!    real(dl), dimension(1:nLat) :: potential
    real(dl) :: dtout
    real(dl) :: temp
    logical  :: o
    integer  :: m
    integer  :: sim
    integer, parameter :: oFile = 98

    tPairgsq%realSpace(:) = fld(:,1)
    call grad_1d_wtype(tPairgsq, dk)
    grad(:) = tPairgsq%realSpace(:)

!    kinetic(:)   = 0.5_dl*(fld(:,2)**2._dl)
!    gradient(:)  = 0.5_dl*(grad(:)**2._dl)
!    potential(:) = 4._dl*nu * (-cos(fld(:,1)) + 0.5_dl*lambda**2._dl * sin(fld(:,1))**2._dl)

    inquire(file='/gpfs/dpirvu/velocity_comparison/supercritical_x'//trim(str(nLat))//'_phi0'//trim(real_str(phi0))//'_lambda'//trim(real_str(lambda))//'_T'//trim(real_str(temp))//'_sim'//trim(str(sim))//'_fields.dat', opened=o)

    if (.not.o) then
       open(unit=oFile,file='/gpfs/dpirvu/velocity_comparison/supercritical_x'//trim(str(nLat))//'_phi0'//trim(real_str(phi0))//'_lambda'//trim(real_str(lambda))//'_T'//trim(real_str(temp))//'_sim'//trim(str(sim))//'_fields.dat')
       write(oFile,*) "# Lattice Parameters dx = ", dx, "nLat = ", nLat, " lenLat = ", lenLat, "dk = ", dk
       write(oFile,*) "# Time Stepping parameters dt_out = ", dtout, " m2eff = ", m2eff, " phi0 = ", phi0, " temperature = ", temp
    endif

    do m = 1, nLat
       write(oFile,*) fld(m,:), grad(m)
    end do

  end subroutine output_fields

end program Gross_Pitaevskii_1d

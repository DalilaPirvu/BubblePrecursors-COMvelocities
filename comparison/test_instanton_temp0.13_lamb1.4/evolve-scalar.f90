!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! BUBBLE CORRELATIONS
#include "macros.h"
#define SMOOTH 1

program Gross_Pitaevskii_1d
  use, intrinsic :: iso_c_binding
  use gaussianRandomField
  use integrator
  use constants
  use eom
  implicit none

  !> Initialise fluctuations in linear perturbation theory approximation
  !> type : (1) sets vacuum
  !>        (2) thermal+vacuum
  !>        (3) only thermal
  real(dl), parameter :: phi0 = twopi / 2.8_dl
  real(dl), parameter :: temp = 0.13
  integer, parameter :: type = 3

  integer :: nTimeMax = nLat
  integer :: sim
  integer :: lSim = 0, nSim = 1

!  integer :: ss
!  integer, dimension(500) :: simList = (/ /)


  real(dl), pointer :: time
  real(dl), dimension(:,:), pointer :: fld
  type(transformPair1D) :: tPairgsq

  fld(1:nLat,1:2) => yvec(1:nVar-1) ! store the field in yvec
  time => yvec(nVar) ! last position stores the time?
  call initialize_rand(93286123,12)
  call setup(nVar)

  do sim = 0, nSim-1
      call initialise_fields(fld, lenLat, m2eff, temp, type, phi0, nyq)
      if (sim >= lSim) then
 !         if (ANY(simList==sim)) then
          call time_evolve(sim, temp, alph)
          print*, "Simulation ", sim, " out of ", nSim , " done!"
 !         endif
      endif
  end do
  print*, "All Done!"

contains

  subroutine initialise_fields(fld, len, m2, temp, type, phi0, klat)
    real(dl), dimension(:,:), intent(inout) :: fld
    real(dl), intent(in) :: len, m2, temp
    integer, intent(in) :: type
    integer, intent(in), optional :: klat
    real(dl), intent(in), optional :: phi0

    fld(:,1) = twopi/2._dl

! instanton
!    fld(:,1) = fld(:,1) + (/0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0014506184561762225, 0.001328910974929709, 0.0012174195216312356, 0.0011152772250548892, 0.001021676404425964, 0.0009359578293581805, 0.0008573819386743509, 0.0007854165501997024, 0.000719507762977134, 0.0006591145360883566, 0.0006038035808360043, 0.0005531269431915398, 0.0005067083026224495, 0.0004641798191151736, 0.000425207720298193, 0.0003895235074815595, 0.0003568249625907072, 0.00032686849907914706, 0.0002994397987410302, 0.00027430401312145136, 0.00025128216458369934, 0.000230195447004089, 0.00021085964196254636, 0.00019314885831489548, 0.00017694009665003563, 0.00016208375483062198, 0.0001484684727643959, 0.00013600428189963765, 0.00012459259348762686, 0.00011413029457862933, 0.0001045484929727003, 9.577914341107885e-05, 8.773674001938403e-05, 8.036282076639978e-05, 7.361133728611691e-05, 6.743623000549093e-05, 6.177875215040984e-05, 5.6590855851190724e-05, 5.184019228421377e-05, 4.7494412625415094e-05, 4.351377859368455e-05, 3.985853395382932e-05, 3.65078313167011e-05, 3.344121837045577e-05, 3.0638242804581495e-05, 2.8073776960013674e-05, 2.5719775273991274e-05, 2.3562419761979925e-05, 2.15884647531972e-05, 1.9784664576860678e-05, 1.8135937549068615e-05, 1.662500295385172e-05, 1.5241574959024007e-05, 1.3975821639089503e-05, 1.2817911068108145e-05, 1.1756651140615304e-05, 1.0778198194838495e-05, 9.894722431180725e-06, 9.081596940241354e-06, 8.338770406624008e-06, 7.6616734538959e-06, 7.0423381965945e-06, 6.47974468481749e-06, 5.9678942347929365e-06, 5.5056511283346765e-06, 5.093015364998621e-06, 4.72998694478477e-06, 4.3390714488111826e-06, 4.022659757296765e-06, 3.7371157239896036e-06, 3.480699334534876e-06, 3.2516348800193384e-06, 3.047181059034898e-06, 2.865734603840764e-06, 2.706360203941216e-06, 2.5681225501728022e-06, 2.4499022988067054e-06, 2.35012274085733e-06, 2.268264760907357e-06, 2.203936389388872e-06, 2.1567456571780497e-06, 2.126258755730248e-06, 2.1120588931111683e-06, 2.1138020604993812e-06, 2.1311445297378384e-06, 2.1637425726694914e-06, 2.21846635106715e-06, 2.2870418683318405e-06, 2.3731859899456254e-06, 2.4774313374109624e-06, 2.600501642024966e-06, 2.743499867730037e-06, 2.907658665840529e-06, 3.094021287619597e-06, 3.3038876012803087e-06, 3.538819338899657e-06, 3.800917472762677e-06, 4.0924948114806625e-06, 4.415500597598765e-06, 4.772244608375331e-06, 5.165409733276505e-06, 5.598626012570662e-06, 6.075884971590284e-06, 6.600112218535514e-06, 7.174813147603487e-06, 7.80411241985135e-06, 8.493239737727976e-06, 9.248119773541674e-06, 1.0073945361011027e-05, 1.0976703622489481e-05, 1.1963499312095394e-05, 1.3042698634890826e-05, 1.4222015874754135e-05, 1.5510151266440175e-05, 1.6917181925091285e-05, 1.8455523609350877e-05, 2.013626195962459e-05, 2.1971531244613374e-05, 2.3975229399564313e-05, 2.6164803442085827e-05, 2.8556490363484954e-05, 3.116736976238599e-05, 3.4016905446243584e-05, 3.712700861591145e-05, 4.0521906401913554e-05, 4.4228143426749966e-05, 4.827467535895025e-05, 5.269224989001842e-05, 5.7514249737877776e-05, 6.27779035373699e-05, 6.852584074357182e-05, 7.479901675644385e-05, 8.164690772005656e-05, 8.912283882445138e-05, 9.728404287789871e-05, 0.00010619213702112162, 0.00011591643257435891, 0.00012653200547863008, 0.00013811903718474738, 0.00015076609707431743, 0.0001645719880145613, 0.00017964325620978272, 0.00019609430015510299, 0.00021405212717207078, 0.00023365541504860587, 0.00025505513816881376, 0.00027841610489209856, 0.0003039166363749679, 0.00033175206890723175, 0.00036213676372609527, 0.00039530450329872124, 0.00043150973106032, 0.00047103185634211897, 0.0005141736921800977, 0.0005612665481273815, 0.0006126728352353616, 0.000668787468245835, 0.0007300413242816717, 0.0007969059479351337, 0.0008698948503407244, 0.0009495683677078759, 0.0010365399639380435, 0.0011314772893324943, 0.001235109072574403, 0.0013482328802481014, 0.0014717176084677597, 0.0016065117880668112, 0.0017536534358075784, 0.0019142717903357642, 0.0020895998891043988, 0.0022809876063019097, 0.0024899039389278954, 0.0027179533045624815, 0.0029668911578917267, 0.003238629037431995, 0.0035352546256639528, 0.0038590524733397302, 0.004212506162138752, 0.004598329197091022, 0.005019489213479833, 0.005479221609751672, 0.005981059562545354, 0.006528859667016995, 0.007126831522673349, 0.0077795721282245545, 0.008492091089331133, 0.009269863584027593, 0.010118865468446536, 0.011045622821463486, 0.01205725967940996, 0.013161536817928976, 0.014366951058419897, 0.015682743087269024, 0.017119005361750705, 0.01868677224656423, 0.020398093246395632, 0.022266095255870866, 0.02430510885186621, 0.026530773825366172, 0.028960153387867393, 0.03161186619154632, 0.03450622417646487, 0.03766538187886237, 0.0411135041461681, 0.04487694336627346, 0.0489844285088501, 0.0534672761741839, 0.05835961433007997, 0.06369861828437129, 0.06952477087566233, 0.07588213558467505, 0.08281864311382003, 0.09038639650463942, 0.09864199901470139, 0.10764686708422788, 0.11746757316134993, 0.12817617682137072, 0.13985054706352518, 0.1525746636877976, 0.1664388755973225, 0.18154010376581775, 0.19798194744304265, 0.2158746653082786, 0.23533499224836785, 0.2564857541263379, 0.27945504112266706, 0.30437515984341657, 0.3313809890974424, 0.36060774139024243, 0.39218795307035315, 0.42624757841091077, 0.4629009978904777, 0.5022449415412944, 0.5443510044380826, 0.5892569653663071, 0.6369568942660053, 0.6873903312537557, 0.7404310229486364, 0.7958759219119815, 0.8534354020864883, 0.9127258593076144, 0.9732659623415216, 1.0344777678395092, 1.0956935149738962, 1.1561685394233372, 1.2150999718190878, 1.2716501431555391, 1.324972955847925, 1.3742411232181357, 1.4186722441738002, 1.457551685062394, 1.490251328855984, 1.5162436221035653, 1.5351112322579468, 1.546552956553139, 1.550387036730207, 1.546552956553139, 1.5351112322579468, 1.5162436221035653, 1.490251328855984, 1.457551685062394, 1.4186722441738002, 1.3742411232181357, 1.324972955847925, 1.2716501431555391, 1.2150999718190878, 1.1561685394233372, 1.0956935149738962, 1.0344777678395092, 0.9732659623415216, 0.9127258593076144, 0.8534354020864883, 0.7958759219119815, 0.7404310229486364, 0.6873903312537557, 0.6369568942660053, 0.5892569653663071, 0.5443510044380826, 0.5022449415412944, 0.4629009978904777, 0.42624757841091077, 0.39218795307035315, 0.36060774139024243, 0.3313809890974424, 0.30437515984341657, 0.27945504112266706, 0.2564857541263379, 0.23533499224836785, 0.2158746653082786, 0.19798194744304265, 0.18154010376581775, 0.1664388755973225, 0.1525746636877976, 0.13985054706352518, 0.12817617682137072, 0.11746757316134993, 0.10764686708422788, 0.09864199901470139, 0.09038639650463942, 0.08281864311382003, 0.07588213558467505, 0.06952477087566233, 0.06369861828437129, 0.05835961433007997, 0.0534672761741839, 0.0489844285088501, 0.04487694336627346, 0.0411135041461681, 0.03766538187886237, 0.03450622417646487, 0.03161186619154632, 0.028960153387867393, 0.026530773825366172, 0.02430510885186621, 0.022266095255870866, 0.020398093246395632, 0.01868677224656423, 0.017119005361750705, 0.015682743087269024, 0.014366951058419897, 0.013161536817928976, 0.01205725967940996, 0.011045622821463486, 0.010118865468446536, 0.009269863584027593, 0.008492091089331133, 0.0077795721282245545, 0.007126831522673349, 0.006528859667016995, 0.005981059562545354, 0.005479221609751672, 0.005019489213479833, 0.004598329197091022, 0.004212506162138752, 0.0038590524733397302, 0.0035352546256639528, 0.003238629037431995, 0.0029668911578917267, 0.0027179533045624815, 0.0024899039389278954, 0.0022809876063019097, 0.0020895998891043988, 0.0019142717903357642, 0.0017536534358075784, 0.0016065117880668112, 0.0014717176084677597, 0.0013482328802481014, 0.001235109072574403, 0.0011314772893324943, 0.0010365399639380435, 0.0009495683677078759, 0.0008698948503407244, 0.0007969059479351337, 0.0007300413242816717, 0.000668787468245835, 0.0006126728352353616, 0.0005612665481273815, 0.0005141736921800977, 0.00047103185634211897, 0.00043150973106032, 0.00039530450329872124, 0.00036213676372609527, 0.00033175206890723175, 0.0003039166363749679, 0.00027841610489209856, 0.00025505513816881376, 0.00023365541504860587, 0.00021405212717207078, 0.00019609430015510299, 0.00017964325620978272, 0.0001645719880145613, 0.00015076609707431743, 0.00013811903718474738, 0.00012653200547863008, 0.00011591643257435891, 0.00010619213702112162, 9.728404287789871e-05, 8.912283882445138e-05, 8.164690772005656e-05, 7.479901675644385e-05, 6.852584074357182e-05, 6.27779035373699e-05, 5.7514249737877776e-05, 5.269224989001842e-05, 4.827467535895025e-05, 4.4228143426749966e-05, 4.0521906401913554e-05, 3.712700861591145e-05, 3.4016905446243584e-05, 3.116736976238599e-05, 2.8556490363484954e-05, 2.6164803442085827e-05, 2.3975229399564313e-05, 2.1971531244613374e-05, 2.013626195962459e-05, 1.8455523609350877e-05, 1.6917181925091285e-05, 1.5510151266440175e-05, 1.4222015874754135e-05, 1.3042698634890826e-05, 1.1963499312095394e-05, 1.0976703622489481e-05, 1.0073945361011027e-05, 9.248119773541674e-06, 8.493239737727976e-06, 7.80411241985135e-06, 7.174813147603487e-06, 6.600112218535514e-06, 6.075884971590284e-06, 5.598626012570662e-06, 5.165409733276505e-06, 4.772244608375331e-06, 4.415500597598765e-06, 4.0924948114806625e-06, 3.800917472762677e-06, 3.538819338899657e-06, 3.3038876012803087e-06, 3.094021287619597e-06, 2.907658665840529e-06, 2.743499867730037e-06, 2.600501642024966e-06, 2.4774313374109624e-06, 2.3731859899456254e-06, 2.2870418683318405e-06, 2.21846635106715e-06, 2.1637425726694914e-06, 2.1311445297378384e-06, 2.1138020604993812e-06, 2.1120588931111683e-06, 2.126258755730248e-06, 2.1567456571780497e-06, 2.203936389388872e-06, 2.268264760907357e-06, 2.35012274085733e-06, 2.4499022988067054e-06, 2.5681225501728022e-06, 2.706360203941216e-06, 2.865734603840764e-06, 3.047181059034898e-06, 3.2516348800193384e-06, 3.480699334534876e-06, 3.7371157239896036e-06, 4.022659757296765e-06, 4.3390714488111826e-06, 4.72998694478477e-06, 5.093015364998621e-06, 5.5056511283346765e-06, 5.9678942347929365e-06, 6.47974468481749e-06, 7.0423381965945e-06, 7.6616734538959e-06, 8.338770406624008e-06, 9.081596940241354e-06, 9.894722431180725e-06, 1.0778198194838495e-05, 1.1756651140615304e-05, 1.2817911068108145e-05, 1.3975821639089503e-05, 1.5241574959024007e-05, 1.662500295385172e-05, 1.8135937549068615e-05, 1.9784664576860678e-05, 2.15884647531972e-05, 2.3562419761979925e-05, 2.5719775273991274e-05, 2.8073776960013674e-05, 3.0638242804581495e-05, 3.344121837045577e-05, 3.65078313167011e-05, 3.985853395382932e-05, 4.351377859368455e-05, 4.7494412625415094e-05, 5.184019228421377e-05, 5.6590855851190724e-05, 6.177875215040984e-05, 6.743623000549093e-05, 7.361133728611691e-05, 8.036282076639978e-05, 8.773674001938403e-05, 9.577914341107885e-05, 0.0001045484929727003, 0.00011413029457862933, 0.00012459259348762686, 0.00013600428189963765, 0.0001484684727643959, 0.00016208375483062198, 0.00017694009665003563, 0.00019314885831489548, 0.00021085964196254636, 0.000230195447004089, 0.00025128216458369934, 0.00027430401312145136, 0.0002994397987410302, 0.00032686849907914706, 0.0003568249625907072, 0.0003895235074815595, 0.000425207720298193, 0.0004641798191151736, 0.0005067083026224495, 0.0005531269431915398, 0.0006038035808360043, 0.0006591145360883566, 0.000719507762977134, 0.0007854165501997024, 0.0008573819386743509, 0.0009359578293581805, 0.001021676404425964, 0.0011152772250548892, 0.0012174195216312356, 0.001328910974929709, 0.0014506184561762225, 0.0015834775132455015, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0/)

! critical slice
 !   fld(:,1) = fld(:,1) + (/0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.016433756370388686, -0.01519706759574202, -0.013690601220010201, -0.012032470673276396, -0.01009902860017542, -0.007814337221481615, -0.005158649657570624, -0.001994012963547398, 0.001597692684671248, 0.005133766667864137, 0.008302191848790663, 0.011004271728228598, 0.013235693120074554, 0.01502961677751502, 0.01618336448387936, 0.01674260406938677, 0.016713437608803172, 0.016341849665693964, 0.015953179747945967, 0.015847228226794297, 0.015932521391468946, 0.015867132383407423, 0.015506274139603704, 0.014829507566212374, 0.013832609896646364, 0.012632538332287613, 0.011353842212775689, 0.009964854557577674, 0.008362252551179505, 0.006635681632811696, 0.005124452048019368, 0.004017044755520782, 0.003143826442956854, 0.002209569901524322, 0.0012719875032796146, 0.00047460811226329724, -0.00017007454657314014, -0.0010016399072911852, -0.0020343635106496727, -0.0034634766011159, -0.005328429744441809, -0.007373585432142171, -0.009073373944742613, -0.010028013891393517, -0.010442897950160734, -0.010485219348883135, -0.010135661316477584, -0.009392538603268719, -0.008300773075345713, -0.0069761502316509905, -0.005473222361063623, -0.0036319590598723472, -0.0011976738557479827, 0.001517863739674219, 0.003692799004720193, 0.0049527948883061335, 0.005477967472036216, 0.005526604142759073, 0.005130484053044615, 0.004244004084000164, 0.00309105869627313, 0.0015847136194326872, -0.0004532478733096923, -0.002986955878680586, -0.00587669017588599, -0.0088090971988386, -0.011651188995178252, -0.01443665236307723, -0.016881281340221488, -0.018433142407995984, -0.018877407676916924, -0.01825357746076728, -0.016996273260363903, -0.01582312190423929, -0.015424154473947294, -0.015748504986959233, -0.016365076573757076, -0.016763553384651964, -0.016968949629148966, -0.01723783773916443, -0.01768901020795388, -0.01818477606483615, -0.01875694478132761, -0.01930828058191114, -0.01953334088098746, -0.019330246084435565, -0.019087811383436293, -0.019066585657559365, -0.019230465865857305, -0.019149790758468566, -0.01831249679022262, -0.01676060970384219, -0.014608338347210204, -0.011729011006705203, -0.007608537007864236, -0.002039293293937927, 0.004730075433809322, 0.012055662937571654, 0.019582108145156152, 0.027171499330375326, 0.03502462874221868, 0.04336767917353335, 0.05256489769569317, 0.06313780163376936, 0.07532500561627486, 0.0887906872497739, 0.10285282187675682, 0.11733494128133204, 0.1321578915822803, 0.1475409470366822, 0.16379366760421155, 0.18092772941582425, 0.19871434786151232, 0.21722524622526684, 0.23658411429136583, 0.256957018340771, 0.2787846131229852, 0.30273391711505226, 0.3291108655175403, 0.35762859364336963, 0.3882731272284383, 0.4211597062930812, 0.4564771459473955, 0.49404313428136737, 0.5337422237483835, 0.5756027724650732, 0.6193691342444434, 0.665029331973122, 0.7127207237874718, 0.7623763431491248, 0.8138762499314467, 0.8673029781400645, 0.9223398409015839, 0.9784766862156857, 1.0349980073072276, 1.091248065153776, 1.1470172295521515, 1.2022634210244307, 1.256853655766692, 1.3102957419736523, 1.361457028929709, 1.4090469535710861, 1.4521416412840589, 1.4904915847678932, 1.5239621077847474, 1.5523480525380764, 1.5755758536467281, 1.5937701213875872, 1.6070579042459432, 1.61590728836119, 1.6208890538615552, 1.6221920154182614, 1.6196413586787326, 1.6126403456249374, 1.600598378883154, 1.583422406190775, 1.561173838938462, 1.533750311994278, 1.5011488053881843, 1.463279302269739, 1.4205304389364182, 1.3736707066322698, 1.3234840998687032, 1.2706357853998895, 1.2158364015218934, 1.1596593596451479, 1.1022798911134215, 1.0441364070709502, 0.9860836564456186, 0.9288770762181882, 0.8731023482183922, 0.8189325943412022, 0.7663223339600735, 0.715562431265476, 0.6668082865090783, 0.6199530473110686, 0.5747196499790541, 0.5311200187402418, 0.48932889690450043, 0.44953261964951263, 0.4117591892406369, 0.3758525605933509, 0.34173095368901807, 0.3095134793370762, 0.27933342118525406, 0.2512786331066228, 0.22541664078762125, 0.20182938107130077, 0.180542962876018, 0.1616354779382605, 0.14521805151816558, 0.13100545559939558, 0.11843784151175685, 0.10724022412957579, 0.09731833766421127, 0.08845528972073602, 0.08018742740261864, 0.07204800438314463, 0.06391279090347712, 0.05610045742476366, 0.04881378602002551, 0.04160976716361464, 0.034401028589948535, 0.02752273469753508, 0.021049146447312594, 0.014889961610939917, 0.009079305653347802, 0.004045939129159404, -0.0002753895320046773, -0.00413130511306159, -0.007630291834020753, -0.010883339266103409, -0.013754607972327637, -0.016473853321522736, -0.01919311794102674, -0.021661702387973936, -0.023418550012045625, -0.024148292267114346, -0.024138149997364522, -0.023871638590897692, -0.023464048002125093, -0.023002204695557804, -0.022184839703590864, -0.020792759360594104, -0.018955209633797043, -0.017001244066463084, -0.01530157886820449, -0.014099028319179752, -0.013246615645554183, -0.012397809006534644, -0.011340553002836984, -0.010098532967440121, -0.008664014952690202, -0.007050213538086325, -0.005297234187980671, -0.003419073762315872, -0.0014314955847396504, 0.000433386182698392, 0.0018586103570612522, 0.0023287849222417556, 0.0017064552054981696, 0.0003136888816426264, -0.0013363749455463925, -0.002952850896199344, -0.004400840142551488, -0.00538820958359798, -0.0056221073028295265, -0.0051400321326391385, -0.004263534796842272, -0.00333883062027418, -0.0029157519280187394, -0.003001547157817974, -0.0033279683245486247, -0.004057510153188559, -0.0056135721413932416, -0.00825852235153457, -0.011625722543832318, -0.015210392996922284, -0.01850066074874812, -0.021464873837967247, -0.024405067333292507, -0.02758639025101095, -0.031133349918791353, -0.03460089110124365, -0.037422360395440446, -0.03924309979944063, -0.03995741081015014, -0.03965809325482006, -0.03846548973461594, -0.03639529362992722, -0.03378140823467124, -0.030926825963783156, -0.028053097193412313, -0.02539718904645616, -0.023219880006338567, -0.02137306612560952, -0.01949178054885481, -0.017261793146134963, -0.014823037363984604, -0.012576451471502104, -0.010768416166736738, -0.009326061435038557, -0.00821659751668502, -0.007336535003596989, -0.006550815248461905, -0.005544402876042742, -0.004121280220865664, -0.00235640839463791, -0.0005702827569642466, 0.0008016485864792422, 0.0015049283853483253, 0.0016514595124657028, 0.001355572599712751, 0.0007061370925263155, -4.624346200365892e-05, -0.0005939998287609605, -0.0008896413042389639, -0.001145299638277475, -0.0014214426495486876, -0.0018594944451155726, -0.002629931178710798, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0/)


! sub-critical slice
    fld(:,1) = fld(:,1) + (/0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.017905382445732254, -0.016311988218928875, -0.014236584886554216, -0.011847287236741888, -0.009438638640027364, -0.007142912993355566, -0.00472892533464897, -0.001738800099514215, 0.0016943341838162596, 0.005004640493588841, 0.00788416070668907, 0.010220410424461424, 0.012190395302450252, 0.01386591282689631, 0.015080406272009572, 0.015771657457220645, 0.015982265834817433, 0.015868558690370627, 0.015556510580551297, 0.015146514158439484, 0.014895480120976412, 0.014782983991433518, 0.014630054361091105, 0.014143779759157926, 0.013271948434468772, 0.012193489799005253, 0.010947250458222424, 0.009433039980086377, 0.007710960352195428, 0.0060502911877216015, 0.004795223263579729, 0.0040058290285451825, 0.0034872807771741954, 0.002868278154409154, 0.0022375641170779836, 0.0015524362094101463, 0.0008375838987064732, -4.2333330150690074e-05, -0.0012479761249450938, -0.002750465195045404, -0.004317174298417825, -0.005729414106571351, -0.006889375815481991, -0.00779668210287765, -0.008359274895585855, -0.008615183789028702, -0.0087724353714691, -0.008764466541593574, -0.008533540487753122, -0.007711730995101362, -0.006145370582784526, -0.0040191848879533865, -0.0013591361050910855, 0.001476884075031215, 0.004046932059863284, 0.005999419990893262, 0.0070888995277287314, 0.00742279473130969, 0.007154270175249611, 0.006429612203933122, 0.005244645659278735, 0.0036064797953967442, 0.0012402761306957721, -0.0016912766385144273, -0.004698486383311273, -0.007296634580217898, -0.009417557383045061, -0.011085911813524696, -0.01253557985763809, -0.013893783247490799, -0.014936971785918907, -0.015401597398395417, -0.015255131169183311, -0.014711069489117268, -0.014040128284517284, -0.013691910712251953, -0.01391277082041853, -0.014373149268104513, -0.01497895742971167, -0.015580997158241683, -0.016331999106356854, -0.0172753939525907, -0.018280876109867172, -0.019178325361379756, -0.01985638791465627, -0.020301504113108493, -0.020610534262343716, -0.020613148366269485, -0.0199824473562229, -0.01882493107593275, -0.017479247782048013, -0.016082333525467618, -0.01414283747260825, -0.010983665455055469, -0.006157248292427475, 9.587988125758784e-05, 0.00715813307495905, 0.014351599490506572, 0.021451175221208096, 0.028601943683400854, 0.03624599564856723, 0.04458888626002322, 0.053916464943100983, 0.06447147773708028, 0.07597700598636736, 0.08825154678175728, 0.10132061081913601, 0.11522459388735573, 0.12975660041862191, 0.14494497653435046, 0.16076073973323002, 0.17711900770175193, 0.1940598391223305, 0.21166704068436326, 0.23022579979245528, 0.2501190497083856, 0.2718850808815487, 0.2956888158794668, 0.32155426799164655, 0.34972877910061495, 0.3804981747329741, 0.41367761715251117, 0.44921825916307423, 0.4870351069816774, 0.5269333105755094, 0.5684938632546062, 0.6115800634889705, 0.6565050484783361, 0.7036022870233647, 0.752981873990433, 0.8045105990501313, 0.8578766638875321, 0.9127349246533969, 0.9686063886436678, 1.0247363590861793, 1.080674001704078, 1.1363641870896055, 1.191612187549656, 1.2459122343327476, 1.2986661529344552, 1.3487137039063741, 1.39486900949629, 1.4363172853908202, 1.4727019412775224, 1.5038703986912347, 1.5300836220065683, 1.5518696968839496, 1.5694596828702378, 1.5827928655382646, 1.5918519704822103, 1.5969146335515356, 1.5983081685694458, 1.5960210227808433, 1.5896507090610132, 1.5788223062571536, 1.5634078676996293, 1.542978575870948, 1.5170593162290302, 1.4854518914206825, 1.4482104134084341, 1.406071069194084, 1.360007166534369, 1.3106525663099982, 1.2585837063507999, 1.2046393568492748, 1.1493079334826861, 1.0925300652075318, 1.0347776436698668, 0.9770803584822243, 0.9202303326258763, 0.8644993546311319, 0.8100865301275362, 0.7572130455452895, 0.7063047841427901, 0.6574400671816849, 0.610572346902948, 0.5654952249365612, 0.5221816781790602, 0.48081995237564046, 0.4414184629498221, 0.40390995794372087, 0.36827903648915017, 0.33465529092083957, 0.3030302713783182, 0.27320548028601577, 0.24528080142708397, 0.21976635089453822, 0.19689921529094168, 0.17669927589614076, 0.1588452171138215, 0.14309965260917723, 0.12922595992867292, 0.11698986577998793, 0.10618628422080567, 0.09662200521252862, 0.08784899617676967, 0.07951713570320162, 0.07155738393698696, 0.06390084623388281, 0.05629901434589435, 0.048755691718840755, 0.04157083089778846, 0.034861425816354874, 0.028485803561890233, 0.0224079499626475, 0.01679806432496589, 0.011696601896341363, 0.007097271968517838, 0.002672570692277443, -0.001509176479030927, -0.005186110439172609, -0.008331672673235868, -0.011053622183259115, -0.0135808709679055, -0.015779299540196412, -0.017670697272458735, -0.019371380361904667, -0.020813397117744437, -0.021633981695836635, -0.02160851039584255, -0.020962340565231496, -0.02013216733901757, -0.0192670020600354, -0.01833994436995212, -0.017256977289971775, -0.01594258054804598, -0.01452046706345822, -0.01312763991073318, -0.011844146174564862, -0.01076946925433342, -0.009743219541633152, -0.008842598683759917, -0.008062393036814441, -0.007062529411502982, -0.0056409491967430725, -0.003948539583161548, -0.0021604389441316485, -0.0005130593949380646, 0.0006035416740277633, 0.0009407709966238187, 0.0005744199782431458, -0.000401267194621191, -0.0016908448446524282, -0.0029394931193280627, -0.0039521070898858035, -0.0045302282410388806, -0.004556877642663881, -0.0040461553454469446, -0.0032701918835300603, -0.0024963426350370632, -0.0020917995257367927, -0.002191477152565735, -0.0029096912766348737, -0.004193973370865578, -0.006046218716480922, -0.008540116273389131, -0.011494008081000207, -0.014786266068125276, -0.018196707591912276, -0.021357551691919774, -0.024222856010543747, -0.027006286317309502, -0.029851080458580093, -0.03254654599456197, -0.034756615254776246, -0.03642873571200411, -0.03756530278995429, -0.03798752076997225, -0.037486302843657615, -0.036167771462667364, -0.03419864945983386, -0.03171115607266817, -0.028924868889109057, -0.026040905446274465, -0.02348031182385668, -0.021447539006708816, -0.019526323509576837, -0.017294190622023642, -0.014589046032801978, -0.0116669549486903, -0.009145764305051873, -0.00731418493721403, -0.006167670811292769, -0.005531716726777436, -0.004875808288121508, -0.0037161643260663624, -0.002142190603034333, -0.0005300971391837273, 0.0006882339341620636, 0.0014803576382975692, 0.0018493090298550285, 0.0018985240729327835, 0.0016658259559210187, 0.001223289083147172, 0.0005734022407284378, -8.372021548908037e-05, -0.0003397196870555952, -0.0002767917414363552, -0.00024467876656197873, -0.0005164342187429227, -0.0012611096127317367, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0/)



    fld(:,2)   = 0
    yvec(nVar) = 0 ! Add a tcur pointer here

 !   call initialize_linear_fluctuations(fld, len, m2, temp, type, phi0, klat)
  end subroutine initialise_fields

  subroutine time_evolve(sim, temp, alp) 
    real(dl) :: temp
    real(dl) :: dt
    real(dl) :: dtout
    real(dl) :: sum_cos_fld
    real(dl) :: alp
    integer :: i, j, k, m
    integer :: sim
    logical :: bool

    dt = dx / alp
!    if (dt > dx) print*, "Warning, violating Courant condition"
    dtout = dt * alp

    call output_fields(fld, dtout, sim, temp)

    i = 1
    k = 1
    bool = .True.

    do while ( i <= nLat/2. )
       do j = 1, int(alp)
          call gl10(yvec, dt)
       end do
       call output_fields(fld, dtout, sim, temp)

       if ( bool ) then
          sum_cos_fld = 0._dl
          do m = 1, nLat
             sum_cos_fld = sum_cos_fld + cos(fld(m,1))
          end do
          sum_cos_fld = sum_cos_fld/nLat
          if ( sum_cos_fld > -0.8_dl ) then
             bool = .False.
          end if

          k = k + 1
          if ( k == nTimeMax) then
             exit
          end if
       else

          i = i + 1
       end if
    end do
  end subroutine time_evolve

  subroutine initialize_linear_fluctuations(fld,len,m2,temp,type,phi0,klat)
    real(dl), dimension(:,:), intent(inout) :: fld
    real(dl), intent(in) :: len, m2, temp
    real(dl), intent(in), optional :: phi0
    integer, intent(in), optional :: klat
    integer, intent(in) :: type

    real(dl), dimension(1:size(fld(:,1))) :: df
    real(dl), dimension(1:size(fld(:,1))/2+1) :: spec, w2eff
    real(dl) :: phiL, norm
    integer :: i, j
    integer :: nn
    integer :: kc

    nn = size(spec)
    kc = size(spec); if (present(klat)) kc = klat
    phiL = twopi; if (present(phi0)) phiL = phi0

    ! Normalise assuming the Box-Mueller transform gives a complex
    ! random deviate with unit variance
    norm = 1._dl / phiL / sqrt(2._dl * len)  

    spec(:) = 0._dl
    do i = 1, nn
       w2eff(i) = m2 + (dk*(i-1))**2._dl
    enddo

    select case (type)
       case (1)  ! Vacuum fluctuations
          spec(2:kc) = norm / w2eff(2:kc)**0.25
!       case (2)  ! Thermal + Vacuum
!          spec(2:kc) = norm / w2eff(2:kc)**0.25 * sqrt(2._dl/(exp(w2eff(2:kc)**0.5/temp)-1._dl)+1._dl)
       case (3)  ! Only Thermal
          spec(2:kc) = norm / w2eff(2:kc)**0.25 * sqrt(2._dl/(exp(w2eff(2:kc)**0.5/temp)-1._dl))
    end select

    df(:) = 0._dl
    call generate_1dGRF(df, spec(1:nn))  ! check if this is correct
    fld(:,1) = fld(:,1) + df(:)

    do j = 2, nn
        spec(j) = spec(j)*(w2eff(j)**0.5)
    enddo

    df(:) = 0._dl
    call generate_1dGRF(df, spec(1:nn))
    fld(:,2) = fld(:,2) + df(:)
  end subroutine initialize_linear_fluctuations

  subroutine setup(nVar)
    integer, intent(in) :: nVar
    call init_integrator(nVar)
    call initialize_transform_1d(tPair,nLat)
    call initialize_transform_1d(tPairgsq,nLat)
  end subroutine setup

  character(len=20) function str(k)
    integer, intent(in) :: k
    write (str, *) k
    str = adjustl(str)
  end function str

  character(len=20) function real_str(k)
    real(dl), intent(in) :: k
    write (real_str, '(f12.4)') k
    real_str = adjustl(real_str)
  end function real_str

  subroutine output_fields(fld, dtout, sim, temp)
    real(dl), dimension(1:nLat, 1:2) :: fld
    real(dl), dimension(1:nLat) :: grad
!    real(dl), dimension(1:nLat) :: kinetic
!    real(dl), dimension(1:nLat) :: gradient
!    real(dl), dimension(1:nLat) :: potential
    real(dl) :: dtout
    real(dl) :: temp
    logical  :: o
    integer  :: m
    integer  :: sim
    integer, parameter :: oFile = 98

    tPairgsq%realSpace(:) = fld(:,1)
    call grad_1d_wtype(tPairgsq, dk)
    grad(:) = tPairgsq%realSpace(:)

!    kinetic(:)   = 0.5_dl*(fld(:,2)**2._dl)
!    gradient(:)  = 0.5_dl*(grad(:)**2._dl)
!    potential(:) = 4._dl*nu * (-cos(fld(:,1)) + 0.5_dl*lambda**2._dl * sin(fld(:,1))**2._dl)
    inquire(file='/gpfs/dpirvu/velocity_comparison/subcritical_x'//trim(str(nLat))//'_phi0'//trim(real_str(phi0))//'_lambda'//trim(real_str(lambda))//'_T'//trim(real_str(temp))//'_sim'//trim(str(sim))//'_fields.dat', opened=o)

    if (.not.o) then
       open(unit=oFile,file='/gpfs/dpirvu/velocity_comparison/subcritical_x'//trim(str(nLat))//'_phi0'//trim(real_str(phi0))//'_lambda'//trim(real_str(lambda))//'_T'//trim(real_str(temp))//'_sim'//trim(str(sim))//'_fields.dat')
       write(oFile,*) "# Lattice Parameters dx = ", dx, "nLat = ", nLat, " lenLat = ", lenLat, "dk = ", dk
       write(oFile,*) "# Time Stepping parameters dt_out = ", dtout, " m2eff = ", m2eff, " phi0 = ", phi0, " temperature = ", temp
    endif

    do m = 1, nLat
       write(oFile,*) fld(m,:), grad(m)
    end do

  end subroutine output_fields

end program Gross_Pitaevskii_1d

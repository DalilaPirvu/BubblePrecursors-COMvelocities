#include "macros.h"
#define SMOOTH 1

program Gross_Pitaevskii_1d
  use, intrinsic :: iso_c_binding
  use gaussianRandomField
  use integrator
  use constants
  use eom
  implicit none

  integer :: sim
  real(dl), pointer :: time
  real(dl), dimension(:,:), pointer :: fld
  type(transformPair1D) :: tPairgsq

  fld(1:nLat,1:2) => yvec(1:nVar-1) ! store the field in yvec
  time => yvec(nVar) ! last position stores the time?
  call initialize_rand(93286123,seedfac)
  call setup(nVar)

  ! change this script to vary over specific parameters, as needed
  do sim = 0, nSim-1
      call initialise_fields(fld, m2eff, temp, type, nyq, norm, fldinit, mominit)
      if (sim >= lSim) then
 !         if (ANY(simList==sim)) then
          call time_evolve(sim, temp, alph)
          print*, "Simulation ", sim, " out of ", nSim , " done!"
 !         endif
      endif
  end do
  print*, "All Done!"

contains

  subroutine initialise_fields(fld, m2, temp, type, kc, norm, fldinit, mominit)
    real(dl), dimension(:,:), intent(inout) :: fld
    real(dl), intent(in) :: m2, temp, norm, fldinit, mominit
    integer,  intent(in) :: type, kc

    fld(:,1)   = fldinit + (/0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.017445959040196968, 0.01580570999527131, 0.014038746296491045, 0.01230714360012497, 0.010891553274381405, 0.009641945354645909, 0.00837153533017787, 0.00669694695597034, 0.004671212930212221, 0.0025383627206299053, 0.00041181312546800797, -0.0014071724189008705, -0.0026247502728011796, -0.0032764589151863532, -0.0035740490776774436, -0.003690829954635433, -0.0038182533538897445, -0.00417049398063396, -0.00478605270246657, -0.005411431430742741, -0.006181103928109888, -0.007232559460286669, -0.008446053880903914, -0.009689994461883789, -0.010868163325606695, -0.011699216953362956, -0.011683050364698744, -0.0108251555747656, -0.009251698195455571, -0.007184146987677664, -0.004970052112295065, -0.0028865353966907037, -0.0011558595948915062, 0.00026767486348378, 0.001358781645178997, 0.002272853963726895, 0.003030762302496548, 0.003345354871460149, 0.0029046121278692993, 0.001585742328248152, -0.0002908771261767029, -0.00216243278145134, -0.0037614243184815876, -0.005280075053061939, -0.006995519883740364, -0.00867569711414573, -0.009808883806389002, -0.010140036256717888, -0.009675120232925938, -0.008716731173038728, -0.0074484332129247655, -0.006068662939725744, -0.004949137544358884, -0.004199803098163812, -0.0037014959947696546, -0.00324894417862831, -0.0027461473802206093, -0.00251918260763917, -0.002875640693504433, -0.003572461704574703, -0.004256648976483923, -0.004531413020869124, -0.004403450421217148, -0.004131557128392416, -0.003822483272270638, -0.0035496281900480042, -0.0038206711325412535, -0.004941455622396784, -0.007002609292578121, -0.00955650879297032, -0.011962816323796144, -0.013644651814772146, -0.014661303417487836, -0.015329267117292655, -0.015624969053925408, -0.015352603535010445, -0.014505239835124861, -0.01291049700820679, -0.010545889029939026, -0.0076723202638340204, -0.004598831655788782, -0.0014293429806917501, 0.0018247007646157165, 0.005040991521409577, 0.007957644537025299, 0.010429821121943128, 0.012479942591416826, 0.014186357474475386, 0.01565678244477109, 0.016876941042219595, 0.017775453065195013, 0.018436134258771553, 0.019043007893495112, 0.01955457890364176, 0.020135260222839513, 0.020691613940234443, 0.021190404594391143, 0.021468760713368784, 0.021568954544305186, 0.02150240819885374, 0.021449489816000256, 0.021818475260763304, 0.022606063463535442, 0.023247256265903182, 0.023348170487994313, 0.02329182026524279, 0.02354500249213487, 0.02435138104324519, 0.02557968610088901, 0.02730493327137662, 0.029243976775827463, 0.031065881350786473, 0.03213227825791343, 0.032140180626432535, 0.031245091252448898, 0.0298469380857993, 0.028242100621794997, 0.026713506365642292, 0.025463164342217404, 0.02475213929434661, 0.024616206307765953, 0.024841204271600414, 0.0251461262533752, 0.025242074156270444, 0.02517221902247435, 0.02497955048542755, 0.024625907647353174, 0.02422247079225892, 0.024008983875233092, 0.023914256198033, 0.02371502127956049, 0.023835036746240768, 0.02470714217950043, 0.026270457281728277, 0.028355909984592476, 0.030676617343774915, 0.03324044917974289, 0.035871749204420045, 0.03842193044570186, 0.04100527619188066, 0.04390685394246763, 0.04720320416890633, 0.05093886190709185, 0.05537620193570891, 0.06067307643071862, 0.06647983860096884, 0.0725129112972751, 0.07892258906919514, 0.08582331451050695, 0.09336463197099087, 0.10132903891285361, 0.10963730573650787, 0.11854184728646944, 0.12866649773782157, 0.14032197235470933, 0.15310849104383184, 0.16649750231337768, 0.18029061899798737, 0.1947566541409742, 0.20997612862444504, 0.22584646579122802, 0.24234055137290378, 0.25973932021192914, 0.2785655352943799, 0.29880680418182637, 0.32002490169119424, 0.3418766553932149, 0.36416277464338354, 0.3868174663349335, 0.40977718599746993, 0.43252870999170323, 0.45503815728572805, 0.47774583921286684, 0.5007888035511145, 0.5242582025984168, 0.5479046273228638, 0.5712568117046462, 0.5943467009106427, 0.6174216660961864, 0.640331118749109, 0.6625240529153325, 0.6837220032269307, 0.7039696907681963, 0.7233966695430105, 0.7421243262635882, 0.7605662009624834, 0.7787162979746016, 0.796418276298478, 0.8135545855729802, 0.8299425905586033, 0.8454022795853664, 0.8597955470470007, 0.8733771724936421, 0.8864937817531873, 0.8990322180907162, 0.9105474055562217, 0.9208585088092871, 0.9297953289990017, 0.9374364324476119, 0.9437314490272968, 0.948300930290805, 0.9507055905018218, 0.9509302154830159, 0.9490124826441253, 0.9447893716099554, 0.9385446194338023, 0.9308471280504227, 0.9218715174473378, 0.9112131403462866, 0.8985047990294737, 0.8836410250014328, 0.8668961068858048, 0.8485359930973457, 0.8290339372984734, 0.8088519067047915, 0.7883983501540981, 0.7678764797156186, 0.7474675950149918, 0.7271828661139326, 0.7065858392776581, 0.6851534730480693, 0.6626823398318713, 0.6394118269239106, 0.6157727582624393, 0.5917319419307825, 0.5672867790923202, 0.542719242534929, 0.5184178330272582, 0.49486002464865164, 0.47233199927745506, 0.45119255324236285, 0.43140296193519045, 0.41238708797645174, 0.39360672241218575, 0.37472139558808726, 0.3555819240478084, 0.3363849204504161, 0.31752570190687823, 0.2995182752380492, 0.2825333441895981, 0.2661504188219572, 0.25009306809603693, 0.23474965925508862, 0.22049172362178782, 0.20718519794706491, 0.1944336472825694, 0.18219640144691907, 0.17057227239953754, 0.1595464664517059, 0.1489638377627105, 0.1389045515413958, 0.12923739097346498, 0.11970339465502455, 0.11017802204981342, 0.10079496110008357, 0.09212076270579184, 0.08453807115696099, 0.07776367486045865, 0.0717107396075205, 0.0664229927312614, 0.061832876939269976, 0.057885447883389674, 0.05475432837431038, 0.05254850569118297, 0.05103746810886722, 0.0500360632929433, 0.04946539441327191, 0.04944603948107407, 0.04982700344741664, 0.05009050278699867, 0.04993224090228976, 0.049167947388023325, 0.047843667040257554, 0.04599455244482842, 0.043897495930582675, 0.041698482259554304, 0.0395741679911179, 0.03778890691303394, 0.03630828421042498, 0.03504580851916117, 0.03420490070709503, 0.03376604371285996, 0.03369161750313765, 0.03385704984180471, 0.0340762133776038, 0.0343489784395401, 0.03498866432045489, 0.035849890289958, 0.036360600463013704, 0.0363313258879403, 0.03585536295919134, 0.035009103223981874, 0.033570527965830266, 0.0316049777728562, 0.029136854701278914, 0.026284502821968925, 0.023086072543209823, 0.019633878821307515, 0.01621485547143031, 0.013324817968713543, 0.01149581865240945, 0.010477348218547622, 0.009824905101982306, 0.009474808565388848, 0.009690065509232682, 0.01044352648722846, 0.011529322818136567, 0.012795814107504633, 0.014241128175272344, 0.015360178939321845, 0.015382200158031711, 0.014335579653288466, 0.012970659148647368, 0.011636958435696787, 0.010131157041841199, 0.008281573039346846, 0.00637861019758601, 0.004764016255807135, 0.003904051433529343, 0.003940866886835703, 0.004715812948496989, 0.005999453060684168, 0.0072749336816593235, 0.0083768649285485, 0.009100209060467712, 0.009377321257513227, 0.009716006561951929, 0.010450231799532972, 0.011410788469133237, 0.012346889736214894, 0.013060817941680458, 0.013193736406738488, 0.012735536250068513, 0.011906650950996411, 0.010909865571085309, 0.009560441608477355, 0.007784059081912265, 0.005804364986471189, 0.0037906762796455773, 0.0019165631053397192, 0.0005919838032224511, -0.00018356955230425243, -0.0004941421297481874, -0.00053752846127475, -0.0008729072424200623, -0.0016199862311294666, -0.0024111264325532566, -0.0028575163048971675, -0.002813646234252065, -0.00230188308421031, -0.0015913316528979315, -0.0009928367069620414, -0.0007268906414288345, -0.0006657986284008821, -0.0004334217267234486, 0.0002556809226716972, 0.0015008563497174165, 0.0031438683284923385, 0.004870694646332829, 0.006400304797695711, 0.007680340076166026, 0.008676141290993034, 0.009181210130023487, 0.009017078717818539, 0.008034045285973068, 0.006570072054650211, 0.00503277231395538, 0.0036465571416202103, 0.0023982963649635813, 0.001068120742534262, -0.00034684428984288473, -0.0015733950414777986, -0.0024889338190385857, -0.003061181369881094, -0.003496563619072024, -0.003939219323603638, -0.004347097446011805, -0.00443024946374404, -0.004150529166424111, -0.0036772341548516607, -0.003437229919529994, -0.0034679441614486883, -0.003919938912411602, -0.0046767738238364664, -0.005363655548420887, -0.00587420715778153, -0.006078237962115818, -0.005857363866681897, -0.005068884147521935, -0.0036025241944526165, -0.0016062241580367953, 0.0005713734320593744, 0.0026149575889449217, 0.004309032015727077, 0.00552275911853517, 0.00615918079654687, 0.0060795752589855034, 0.0054009127856429195, 0.004407087233857521, 0.0034372142966017094, 0.0029253286399382183, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0/)
    
    
    
    !(/0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.021782638739085147, -0.0208312157664583, -0.019527404323708364, -0.018316731316301738, -0.01704969681031443, -0.015558027982949252, -0.013936138900036976, -0.012119090438134972, -0.010356853261478172, -0.008266176709172957, -0.005612512072080467, -0.002468471195145927, 0.0004104124855048852, 0.002772221580420897, 0.004643604756162656, 0.006466202452832359, 0.008137987424215343, 0.009237233633564657, 0.009677076670449036, 0.009565798694403327, 0.00914570587856689, 0.008455254911398757, 0.007503180984582691, 0.006155891463500041, 0.004500713703744719, 0.0025520401308214424, 0.0006029510048763953, -0.0009994795492707098, -0.0024216426259480173, -0.003937609056032798, -0.005487212210873782, -0.006701885081187076, -0.007105652411175445, -0.006255255870712961, -0.004532625306821192, -0.002597885182824111, -0.0009057858395915552, 0.00041640229508033144, 0.001246977704024932, 0.0014108128089884708, 0.0010237943827546836, 0.0004941153413113852, 0.00012564344540422212, -7.890979708635726e-05, -0.00015984230949017686, -0.0003700129320471923, -0.0009235751418090743, -0.0016352169743116818, -0.002037960703876074, -0.0018597416712915482, -0.001313536777057589, -0.0007922460767710859, -0.0006863124792850783, -0.0012467617818519017, -0.002477163516284797, -0.0038717348621011283, -0.004885486353893853, -0.005462470055518143, -0.005800335070549334, -0.005977409186503024, -0.005597064721153622, -0.004377390791746372, -0.0025467927446327643, -0.0006028464640608355, 0.0011042527516553768, 0.0024862355656103396, 0.0035534899066980152, 0.004298611517812745, 0.004747161501934549, 0.004920943737539485, 0.005146340855279874, 0.005678612948080808, 0.006247209604302473, 0.006452183995945493, 0.006413493833959727, 0.006248145441737574, 0.006193015834860205, 0.006464394682831998, 0.006971672020264386, 0.0076124812236786354, 0.008180966850344085, 0.008190129115161593, 0.007218902189606524, 0.005206165903453908, 0.0027743101003721016, 0.0008179727005757087, -0.00011419612231788889, -0.00017893008539404676, 8.433304378741013e-05, 0.00029775611782278943, 0.0004069925152214715, 0.0007212073750602066, 0.0015992600790557532, 0.003304827295689705, 0.0057070731281543274, 0.00854593766182754, 0.011301668283607125, 0.013399939946421746, 0.0146761520773242, 0.015421533398910281, 0.015666645472575347, 0.015513567838435716, 0.015212107140247344, 0.014933140206252471, 0.014828698618317926, 0.014837694130990453, 0.01516003006483757, 0.015681471475854192, 0.01609445841348789, 0.01617075103137733, 0.015749438600287213, 0.014896307101102568, 0.013581998178502808, 0.011820950399639152, 0.009756736444745506, 0.007612285386597417, 0.005896614068101158, 0.004907783494300766, 0.004303983208561402, 0.003982037852601206, 0.00400134384260431, 0.004303907186768097, 0.004607754725929336, 0.0048290451874515306, 0.005126348944830106, 0.005425933877516442, 0.005701990353537578, 0.005767656263290899, 0.005469515954521498, 0.004694414863766649, 0.003612266635986572, 0.0022867407206885737, 0.000914550843763795, -0.0004551341662812902, -0.0015755936060277698, -0.0025323042236422566, -0.0033584297964952547, -0.003916640536553384, -0.0038248360710464446, -0.002619068789146084, -0.00044433460203174846, 0.0021525934433812566, 0.00497743454816435, 0.008236500121399981, 0.011943102091021451, 0.015632634700674775, 0.01913245764471272, 0.022786562654154352, 0.02670595298327383, 0.031035107723210942, 0.035605966907712006, 0.04033922784504984, 0.045154110206065745, 0.049891434900050324, 0.054650840957782165, 0.059718126107910496, 0.06557703098500811, 0.07287360174048585, 0.0820764889680543, 0.09308373824165095, 0.1053476971357159, 0.11869771758608527, 0.1333529540348688, 0.14969418949404067, 0.16751407008605312, 0.1866177458358571, 0.2069696401950556, 0.22849938291910732, 0.25143508805958215, 0.2760272889137143, 0.30246660084474675, 0.330826476384364, 0.36112177106779475, 0.39350590925360907, 0.42795184412250364, 0.46440272018531337, 0.5032773055065469, 0.5453171616619881, 0.5909918934657394, 0.6400195559239101, 0.6917557406936985, 0.7458039736910589, 0.8019855976879127, 0.8601429112089667, 0.9198014397221517, 0.9800244931747146, 1.039908533052727, 1.0989910765011164, 1.1569724182160535, 1.213440079684803, 1.2680519766495975, 1.3199382351705706, 1.368399395080397, 1.4131255848088582, 1.4534197132001179, 1.488424525441883, 1.5178554909827655, 1.5415399838447694, 1.559390401740706, 1.5715708771645884, 1.5782878699659806, 1.5796673604454998, 1.5757059078244762, 1.566541550274783, 1.5519393882099077, 1.5316091435785433, 1.5053228177476603, 1.473202638726688, 1.436177223474628, 1.3950906241391499, 1.3503592827755595, 1.302376361702974, 1.251422857587464, 1.198231985360299, 1.1438070548724042, 1.089059122390596, 1.0343289690392616, 0.9796457152955362, 0.9250625928226137, 0.8705374678354794, 0.8164858352735784, 0.7637636162728607, 0.7129566483699437, 0.6640518741458261, 0.6169388712789958, 0.5713083267138734, 0.5268967866924066, 0.483942437186375, 0.442869409111053, 0.40392092453717465, 0.3673265993407471, 0.3332477754487799, 0.3018349522667698, 0.27302672746291456, 0.24630313898956757, 0.2211084374059653, 0.19725742464618223, 0.17508222209118118, 0.1543390475902875, 0.13464735592302324, 0.11611466212619037, 0.09936686099892089, 0.08480702955877151, 0.07280024403647589, 0.06304800064519656, 0.05521571043489182, 0.04891167715860334, 0.043855457550271204, 0.03981423726725808, 0.03679797787738526, 0.03444949479118398, 0.03256641032221541, 0.03106687106547401, 0.029995299885272608, 0.02908603629339135, 0.02811818389362708, 0.026909613935469423, 0.025394758565132847, 0.023728180890389083, 0.022028772595611645, 0.020268612727102564, 0.018467791414722434, 0.016847876499852088, 0.015546874088463447, 0.014687244989772807, 0.014313704434033347, 0.013960158833655978, 0.013364616746918134, 0.01267529738103157, 0.012099772710004508, 0.012121412586571623, 0.012874353747675205, 0.013761760705083503, 0.01413324884037337, 0.013797264811688414, 0.012788111150132675, 0.011355233981543478, 0.010020230534587338, 0.008868411242929142, 0.007688712582853974, 0.006253608356173501, 0.004556169543446398, 0.0027103240819483787, 0.00112295593435352, 5.904816959168002e-05, -0.0005540118978419883, -0.0008153897280895883, -0.0006830232517471835, -0.0002010474208473667, 0.0005890134041894868, 0.0014116562823875967, 0.00244489917501145, 0.004077904525472853, 0.006223268776909485, 0.008532348395867917, 0.010678764121669904, 0.01255112730044905, 0.014237752556951921, 0.015293670400222226, 0.015381117870643113, 0.014601276144852182, 0.013726509117282681, 0.013230508957943865, 0.013144556663173823, 0.013574221877314052, 0.014758427787116446, 0.016643394357782615, 0.01844868490736662, 0.019380377105358004, 0.019046248317130754, 0.017574133162387096, 0.015563151531546193, 0.013509308734949599, 0.011533433102842494, 0.009911637804477902, 0.008846227563119147, 0.008163185203528656, 0.0075085294537400316, 0.006904462004650114, 0.0066706633248307945, 0.006927560547096423, 0.007292702513717497, 0.007386406711294757, 0.007183594351655387, 0.00657700024147978, 0.0053646734197227985, 0.003621132631632662, 0.0019263441256707203, 0.0006703933682561392, -0.0003405204913806692, -0.0012990249033970613, -0.001908717740681798, -0.0017633615331211772, -0.0005809196651984649, 0.001258236029981763, 0.003102280415557601, 0.004416861229912694, 0.005242349963702875, 0.006079587973365719, 0.007280541329609758, 0.008982337184713973, 0.011206112349071873, 0.013930249360468938, 0.01687960769073893, 0.019764939995464026, 0.02222250623468458, 0.023879956928500423, 0.024650179741528166, 0.024650781522929766, 0.023897933322315712, 0.022370387870975783, 0.02031654915230563, 0.01808716367727392, 0.015807926446925524, 0.013533949161168568, 0.011600087751293398, 0.01033808127410607, 0.010172825923175921, 0.010988864493707506, 0.01200265491148933, 0.01270226532166463, 0.012981220496088852, 0.013049748870857414, 0.013277458949006338, 0.013301129919231158, 0.013473131626014823, 0.013629627650122877, 0.013597095067039877, 0.0135368524869115, 0.013490169199988689, 0.013503636380834294, 0.01360890433428974, 0.01389131414384348, 0.01424912123754618, 0.014579444466539027, 0.015026261825453968, 0.015588093471655462, 0.015882821547762216, 0.01571283334878748, 0.015128205046219367, 0.014064207005676455, 0.012805931560181172, 0.011498598192654086, 0.009852770212797513, 0.007956861275617566, 0.006441724260362047, 0.005603830684740796, 0.005249368065849858, 0.005102137463276257, 0.005064012503085191, 0.005014838466522065, 0.004809047905542041, 0.004294825046142758, 0.003472880742894091, 0.0024433394724696633, 0.0013937128736221105, 0.00016971048544922596, -0.0013638037810532744, -0.0032571692004101926, -0.0052747429860660056, -0.007030863253204345, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0/)

    
    
    
    
    
!(/0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.00011989286920410791, 0.0007926461661846851, 0.001709911831062172, 0.0026373745049195207, 0.003580564647065021, 0.004545110062433189, 0.005536758291995625, 0.0065614210629934, 0.007625210131498861, 0.008734467033626014, 0.009895810868652877, 0.011116164905561554, 0.012402798644587154, 0.013763396773188052, 0.015206053168829392, 0.016739355524720168, 0.018372441980956555, 0.020115054925737397, 0.021977573076205736, 0.02397108540726922, 0.026107457861235694, 0.028399407632247353, 0.030860566722867855, 0.033505574492355805, 0.0363501471892036, 0.039411186897412964, 0.04270685798311913, 0.04625671322725822, 0.05008178098350502, 0.05420470956039347, 0.058649867018084834, 0.06344349055014264, 0.06861382487866718, 0.07419127036405992, 0.0802085445757772, 0.08670084460403782, 0.09370602079123724, 0.10126475720633499, 0.1094207583280622, 0.11822093398542055, 0.12771558630334034, 0.13795859860287552, 0.1490076100571156, 0.16092418092440708, 0.17377393721100143, 0.1876266780094995, 0.20255644451983112, 0.21864152615255428, 0.23596438687433174, 0.25461149528167093, 0.27467301571028413, 0.29624233628793695, 0.31941539127638485, 0.3442897305579322, 0.37096328329788975, 0.39953275986064085, 0.430091626951691, 0.4627275993682649, 0.49751959108721255, 0.5345340741856415, 0.5738208373796865, 0.6154081435014414, 0.6592973537584119, 0.7054571351998331, 0.7538174755187308, 0.8042637620503377, 0.8566313303719615, 0.9107009658676404, 0.9661958227023639, 1.0227802951015192, 1.080061300465565, 1.1375922589732355, 1.1948799230804292, 1.2513938326604634, 1.3065779791723529, 1.3598640216405178, 1.4106851716001199, 1.4584899276322165, 1.5027543827199255, 1.5429931864989923, 1.5787680436476252, 1.6096939393272311, 1.6354431071301434, 1.655747227969596, 1.6703981812210413, 1.6792477161613721, 1.6822073464102072, 1.6792477161613721, 1.6703981812210413, 1.655747227969596, 1.6354431071301434, 1.6096939393272311, 1.5787680436476252, 1.5429931864989923, 1.5027543827199255, 1.4584899276322165, 1.4106851716001199, 1.3598640216405178, 1.3065779791723529, 1.2513938326604634, 1.1948799230804292, 1.1375922589732355, 1.080061300465565, 1.0227802951015192, 0.9661958227023639, 0.9107009658676404, 0.8566313303719615, 0.8042637620503377, 0.7538174755187308, 0.7054571351998331, 0.6592973537584119, 0.6154081435014414, 0.5738208373796865, 0.5345340741856415, 0.49751959108721255, 0.4627275993682649, 0.430091626951691, 0.39953275986064085, 0.37096328329788975, 0.3442897305579322, 0.31941539127638485, 0.29624233628793695, 0.27467301571028413, 0.25461149528167093, 0.23596438687433174, 0.21864152615255428, 0.20255644451983112, 0.1876266780094995, 0.17377393721100143, 0.16092418092440708, 0.1490076100571156, 0.13795859860287552, 0.12771558630334034, 0.11822093398542055, 0.1094207583280622, 0.10126475720633499, 0.09370602079123724, 0.08670084460403782, 0.0802085445757772, 0.07419127036405992, 0.06861382487866718, 0.06344349055014264, 0.058649867018084834, 0.05420470956039347, 0.05008178098350502, 0.04625671322725822, 0.04270685798311913, 0.039411186897412964, 0.0363501471892036, 0.033505574492355805, 0.030860566722867855, 0.028399407632247353, 0.026107457861235694, 0.02397108540726922, 0.021977573076205736, 0.020115054925737397, 0.018372441980956555, 0.016739355524720168, 0.015206053168829392, 0.013763396773188052, 0.012402798644587154, 0.011116164905561554, 0.009895810868652877, 0.008734467033626014, 0.007625210131498861, 0.0065614210629934, 0.005536758291995625, 0.004545110062433189, 0.003580564647065021, 0.0026373745049195207, 0.001709911831062172, 0.0007926461661846851, -0.00011989286920410791, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0/)

    
    
    
! this one collapses
!    (/0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.277526187759008e-08, 6.28170475636125e-08, 6.326392032462991e-08, 6.408844432925775e-08, 6.531329566072941e-08, 6.698016452588718e-08, 6.908905136882026e-08, 7.152482472960742e-08, 7.44630663795931e-08, 7.794423195761624e-08, 8.196832190776604e-08, 8.65353362300425e-08, 9.164527448035642e-08, 9.729813754688621e-08, 1.0349713175372699e-07, 1.1027868174195987e-07, 1.1765305174549212e-07, 1.2562024265250216e-07, 1.3418025313072235e-07, 1.4333308451242033e-07, 1.5307873546532846e-07, 1.6773816957638132e-07, 1.8056618156236937e-07, 1.944136260867424e-07, 2.0939640776873603e-07, 2.256304325598535e-07, 2.4323160419115197e-07, 2.623158281700455e-07, 2.8299611276594305e-07, 3.051607584403371e-07, 3.288663332767783e-07, 3.5434740830453393e-07, 3.818385541087821e-07, 4.1157434305105767e-07, 4.437893457165387e-07, 4.787181340226709e-07, 5.16485344270734e-07, 5.572599728331795e-07, 6.013450715158797e-07, 6.49043694789242e-07, 7.006588957914062e-07, 7.564937285486906e-07, 8.168512457551458e-07, 8.821315633511517e-07, 9.52745839111202e-07, 1.0289219871673083e-06, 1.1108858148922707e-06, 1.1988631287707108e-06, 1.2962666828819636e-06, 1.3998560430827922e-06, 1.5117938141351317e-06, 1.6326790888143705e-06, 1.763198355320128e-06, 1.9041254990526113e-06, 2.0563361533554314e-06, 2.221104697941456e-06, 2.3994025966089794e-06, 2.592128894196577e-06, 2.8003246494989753e-06, 3.02517293571114e-06, 3.2680630273063116e-06, 3.530944362228894e-06, 3.815218591718406e-06, 4.122324023025925e-06, 4.4539204178128955e-06, 4.811888991262947e-06, 5.198318453025763e-06, 5.6154855752055255e-06, 6.065966909218901e-06, 6.552561911288279e-06, 7.078282881156639e-06, 7.646354961643453e-06, 8.260112268398956e-06, 8.923038441022157e-06, 9.639159242347262e-06, 1.0412690790051471e-05, 1.1248895875670684e-05, 1.2151819093197957e-05, 1.3127168125404154e-05, 1.4180869329916135e-05, 1.5319246712941492e-05, 1.6548957712192447e-05, 1.7877102305607906e-05, 1.931186127723805e-05, 2.0861948407890907e-05, 2.2536652109828026e-05, 2.4345561532523874e-05, 2.629955250466054e-05, 2.8410546204060694e-05, 3.069123306564947e-05, 3.3155025974895835e-05, 3.58161444249383e-05, 3.869083459884237e-05, 4.179646619251187e-05, 4.5151604045390314e-05, 4.877540791570212e-05, 5.268956958914828e-05, 5.691808198271531e-05, 6.148645557946253e-05, 6.642176155180479e-05, 7.175265639958184e-05, 7.751145238676926e-05, 8.373282543283622e-05, 9.04536945935952e-05, 9.771329220287228e-05, 0.000105555670876889, 0.00011402805305982255, 0.00012318075851780463, 0.00013306732615570027, 0.00014374743230094467, 0.00015528516563900752, 0.00016774892565374344, 0.00018121142246796396, 0.00019575418798645217, 0.0002114647855671059, 0.0002284368287983618, 0.00024677031883335587, 0.0002665753582498098, 0.0002879705310663283, 0.00031108361133913576, 0.0003360528874480906, 0.0003630263798268807, 0.0003921643103530492, 0.0004236403774431352, 0.00045764291652039546, 0.0004943744651533244, 0.0005340541275238309, 0.0005769188874777953, 0.0006232240872048322, 0.0006732455512779012, 0.0007272819449388734, 0.0007856555601755133, 0.0008487141043844737, 0.0009168338787515218, 0.0009904215787761572, 0.0010699153729403221, 0.0011557892882163578, 0.0012485564535307248, 0.0013487690987896706, 0.0014570243370557456, 0.0015739687040627892, 0.0017002993146841838, 0.00183676902184704, 0.001984192706428356, 0.0021434498950383407, 0.0023154886363689897, 0.002501335130723259, 0.002702099299746852, 0.0029189763224022336, 0.003153259105425743, 0.0034063470789473804, 0.0036797483080919235, 0.003975092408651459, 0.0042941441209776166, 0.004638804879281366, 0.005011126323939852, 0.005413329186025884, 0.005847813357107601, 0.006317168333660472, 0.006824193459174843, 0.0073719121419437705, 0.007963590409616028, 0.008602758740418714, 0.009293223655183258, 0.010039100591576311, 0.010844837742896907, 0.011715237636294784, 0.0126554948945925, 0.013671212535742328, 0.014768439410542289, 0.015953730340825256, 0.017234131464106905, 0.018617261944289698, 0.02011136345245479, 0.021725349624249102, 0.023468830757321424, 0.025352184431314484, 0.027386618218111725, 0.02958424011092653, 0.03195811792044578, 0.034522368985550944, 0.03729222604897853, 0.040284143839463216, 0.0435158723201865, 0.04700658082488385, 0.050776942467865016, 0.054849276822224624, 0.05924764734104393, 0.06399800914022791, 0.0691283456506393, 0.07466881510416723, 0.08065191067911925, 0.08711262142313503, 0.09408860470629143, 0.10162036553180975, 0.1097514421088377, 0.11852858973283364, 0.12800196680099374, 0.13822532279939814, 0.14925617210305875, 0.16115595839465557, 0.17399019860177267, 0.1878285895067715, 0.20274507607498782, 0.21881785694690548, 0.23612931015678162, 0.2547658226464291, 0.2748174808268993, 0.29637759813713505, 0.3195420369279569, 0.34440827754583303, 0.37107418165567907, 0.39963639389953354, 0.43018831687569126, 0.46281760286562346, 0.4976031050229577, 0.5346112366139617, 0.5738917300603088, 0.6154727951764922, 0.6593557444313722, 0.7055092016712123, 0.7538631184044156, 0.8043028544236646, 0.856663728085417, 0.9107265194831431, 0.9662143906847138, 1.0227917578322163, 1.0800655743787555, 1.137589309972169, 1.1948697783400002, 1.2513765899607279, 1.3065538130593515, 1.3598331860221613, 1.4106479987138547, 1.45844682369452, 1.5027058208485764, 1.5429396978109802, 1.5787102073900146, 1.6096323729826754, 1.635378457164009, 1.6556801617470258, 1.6703293803733468, 1.6791778712977532, 1.682137153030351, 1.6791778712977532, 1.6703293803733468, 1.6556801617470258, 1.635378457164009, 1.6096323729826754, 1.5787102073900146, 1.5429396978109802, 1.5027058208485764, 1.45844682369452, 1.4106479987138547, 1.3598331860221613, 1.3065538130593515, 1.2513765899607279, 1.1948697783400002, 1.137589309972169, 1.0800655743787555, 1.0227917578322163, 0.9662143906847138, 0.9107265194831431, 0.856663728085417, 0.8043028544236646, 0.7538631184044156, 0.7055092016712123, 0.6593557444313722, 0.6154727951764922, 0.5738917300603088, 0.5346112366139617, 0.4976031050229577, 0.46281760286562346, 0.43018831687569126, 0.39963639389953354, 0.37107418165567907, 0.34440827754583303, 0.3195420369279569, 0.29637759813713505, 0.2748174808268993, 0.2547658226464291, 0.23612931015678162, 0.21881785694690548, 0.20274507607498782, 0.1878285895067715, 0.17399019860177267, 0.16115595839465557, 0.14925617210305875, 0.13822532279939814, 0.12800196680099374, 0.11852858973283364, 0.1097514421088377, 0.10162036553180975, 0.09408860470629143, 0.08711262142313503, 0.08065191067911925, 0.07466881510416723, 0.0691283456506393, 0.06399800914022791, 0.05924764734104393, 0.054849276822224624, 0.050776942467865016, 0.04700658082488385, 0.0435158723201865, 0.040284143839463216, 0.03729222604897853, 0.034522368985550944, 0.03195811792044578, 0.02958424011092653, 0.027386618218111725, 0.025352184431314484, 0.023468830757321424, 0.021725349624249102, 0.02011136345245479, 0.018617261944289698, 0.017234131464106905, 0.015953730340825256, 0.014768439410542289, 0.013671212535742328, 0.0126554948945925, 0.011715237636294784, 0.010844837742896907, 0.010039100591576311, 0.009293223655183258, 0.008602758740418714, 0.007963590409616028, 0.0073719121419437705, 0.006824193459174843, 0.006317168333660472, 0.005847813357107601, 0.005413329186025884, 0.005011126323939852, 0.004638804879281366, 0.0042941441209776166, 0.003975092408651459, 0.0036797483080919235, 0.0034063470789473804, 0.003153259105425743, 0.0029189763224022336, 0.002702099299746852, 0.002501335130723259, 0.0023154886363689897, 0.0021434498950383407, 0.001984192706428356, 0.00183676902184704, 0.0017002993146841838, 0.0015739687040627892, 0.0014570243370557456, 0.0013487690987896706, 0.0012485564535307248, 0.0011557892882163578, 0.0010699153729403221, 0.0009904215787761572, 0.0009168338787515218, 0.0008487141043844737, 0.0007856555601755133, 0.0007272819449388734, 0.0006732455512779012, 0.0006232240872048322, 0.0005769188874777953, 0.0005340541275238309, 0.0004943744651533244, 0.00045764291652039546, 0.0004236403774431352, 0.0003921643103530492, 0.0003630263798268807, 0.0003360528874480906, 0.00031108361133913576, 0.0002879705310663283, 0.0002665753582498098, 0.00024677031883335587, 0.0002284368287983618, 0.0002114647855671059, 0.00019575418798645217, 0.00018121142246796396, 0.00016774892565374344, 0.00015528516563900752, 0.00014374743230094467, 0.00013306732615570027, 0.00012318075851780463, 0.00011402805305982255, 0.000105555670876889, 9.771329220287228e-05, 9.04536945935952e-05, 8.373282543283622e-05, 7.751145238676926e-05, 7.175265639958184e-05, 6.642176155180479e-05, 6.148645557946253e-05, 5.691808198271531e-05, 5.268956958914828e-05, 4.877540791570212e-05, 4.5151604045390314e-05, 4.179646619251187e-05, 3.869083459884237e-05, 3.58161444249383e-05, 3.3155025974895835e-05, 3.069123306564947e-05, 2.8410546204060694e-05, 2.629955250466054e-05, 2.4345561532523874e-05, 2.2536652109828026e-05, 2.0861948407890907e-05, 1.931186127723805e-05, 1.7877102305607906e-05, 1.6548957712192447e-05, 1.5319246712941492e-05, 1.4180869329916135e-05, 1.3127168125404154e-05, 1.2151819093197957e-05, 1.1248895875670684e-05, 1.0412690790051471e-05, 9.639159242347262e-06, 8.923038441022157e-06, 8.260112268398956e-06, 7.646354961643453e-06, 7.078282881156639e-06, 6.552561911288279e-06, 6.065966909218901e-06, 5.6154855752055255e-06, 5.198318453025763e-06, 4.811888991262947e-06, 4.4539204178128955e-06, 4.122324023025925e-06, 3.815218591718406e-06, 3.530944362228894e-06, 3.2680630273063116e-06, 3.02517293571114e-06, 2.8003246494989753e-06, 2.592128894196577e-06, 2.3994025966089794e-06, 2.221104697941456e-06, 2.0563361533554314e-06, 1.9041254990526113e-06, 1.763198355320128e-06, 1.6326790888143705e-06, 1.5117938141351317e-06, 1.3998560430827922e-06, 1.2962666828819636e-06, 1.1988631287707108e-06, 1.1108858148922707e-06, 1.0289219871673083e-06, 9.52745839111202e-07, 8.821315633511517e-07, 8.168512457551458e-07, 7.564937285486906e-07, 7.006588957914062e-07, 6.49043694789242e-07, 6.013450715158797e-07, 5.572599728331795e-07, 5.16485344270734e-07, 4.787181340226709e-07, 4.437893457165387e-07, 4.1157434305105767e-07, 3.818385541087821e-07, 3.5434740830453393e-07, 3.288663332767783e-07, 3.051607584403371e-07, 2.8299611276594305e-07, 2.623158281700455e-07, 2.4323160419115197e-07, 2.256304325598535e-07, 2.0939640776873603e-07, 1.944136260867424e-07, 1.8056618156236937e-07, 1.6773816957638132e-07, 1.5307873546532846e-07, 1.4333308451242033e-07, 1.3418025313072235e-07, 1.2562024265250216e-07, 1.1765305174549212e-07, 1.1027868174195987e-07, 1.0349713175372699e-07, 9.729813754688621e-08, 9.164527448035642e-08, 8.65353362300425e-08, 8.196832190776604e-08, 7.794423195761624e-08, 7.44630663795931e-08, 7.152482472960742e-08, 6.908905136882026e-08, 6.698016452588718e-08, 6.531329566072941e-08, 6.408844432925775e-08, 6.326392032462991e-08, 6.28170475636125e-08, 6.277526187759008e-08, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0/)

    
    fld(:,2)   = mominit
    yvec(nVar) = 0 ! Add a tcur pointer here

!    call initialize_linear_fluctuations(fld, m2, temp, type, kc, norm)
  end subroutine initialise_fields

  subroutine time_evolve(sim, temp, alp) 
    real(dl) :: temp
    real(dl) :: dt
    real(dl) :: dtout
    real(dl) :: sum_cos_fld
    real(dl) :: alp
    integer :: i, j, k, m
    integer :: sim
    logical :: bool

    dt = dx / alp
!    if (dt > dx) print*, "Warning, violating Courant condition"
    dtout = dt * alp

    call output_fields(fld, dtout, sim, temp)

    i = 1
    k = 1
    bool = .True.

    do while ( i <= nLat/2. )
       do j = 1, int(alp)
          call gl10(yvec, dt)
       end do
       call output_fields(fld, dtout, sim, temp)

       if ( bool ) then
          sum_cos_fld = 0._dl
          do m = 1, nLat
             sum_cos_fld = sum_cos_fld + cos(fld(m,1))
          end do
          sum_cos_fld = sum_cos_fld/nLat

          if ( sum_cos_fld > -0.7_dl ) then
             bool = .False.
          end if

          k = k + 1
          if ( k == nTimeMax) then
             exit
          end if
       else

          i = i + 1
       end if
    end do
  end subroutine time_evolve

  subroutine initialize_linear_fluctuations(fld, m2, temp, type, kc, norm)
    real(dl), dimension(:,:), intent(inout) :: fld
    real(dl), intent(in) :: m2, temp, norm
    integer, intent(in) :: type, kc

    real(dl), dimension(1:size(fld(:,1))) :: df
    real(dl), dimension(1:size(fld(:,1))/2+1) :: spec, w2eff
    integer :: i, j, nn

    nn = size(spec)
    spec(:) = 0._dl
    do i = 1, nn
       w2eff(i) = m2 + (dk*(i-1))**2._dl
    enddo

    select case (type)
       case (1)  ! Vacuum fluctuations
          spec(2:kc) = norm / w2eff(2:kc)**0.25
       case (2)  ! Thermal + Vacuum
          spec(2:kc) = norm / w2eff(2:kc)**0.25 * sqrt(2._dl/(exp(w2eff(2:kc)**0.5/temp)-1._dl)+1._dl)
       case (3)  ! Only Thermal
          spec(2:kc) = norm / w2eff(2:kc)**0.25 * sqrt(2._dl/(exp(w2eff(2:kc)**0.5/temp)-1._dl))
    end select

    df(:) = 0._dl
    call generate_1dGRF(df, spec(1:nn))  ! check if this is correct
    fld(:,1) = fld(:,1) + df(:)

    do j = 2, nn
        spec(j) = spec(j)*(w2eff(j)**0.5)
    enddo

    df(:) = 0._dl
    call generate_1dGRF(df, spec(1:nn))
    fld(:,2) = fld(:,2) + df(:)
  end subroutine initialize_linear_fluctuations

  subroutine setup(nVar)
    integer, intent(in) :: nVar
    call init_integrator(nVar)
    call initialize_transform_1d(tPair,nLat)
    call initialize_transform_1d(tPairgsq,nLat)
  end subroutine setup

  character(len=20) function str(k)
    integer, intent(in) :: k
    write (str, *) k
    str = adjustl(str)
  end function str

  character(len=20) function real_str(k)
    real(dl), intent(in) :: k
    write (real_str, '(f12.4)') k
    real_str = adjustl(real_str)
  end function real_str

  subroutine output_fields(fld, dtout, sim, temp)
    real(dl), dimension(1:nLat, 1:2) :: fld
    real(dl), dimension(1:nLat) :: grad
!    real(dl), dimension(1:nLat) :: kinetic
!    real(dl), dimension(1:nLat) :: gradient
!    real(dl), dimension(1:nLat) :: potential
    real(dl) :: dtout, temp
    integer  :: m, sim
    logical  :: o
    integer, parameter :: oFile = 98

    tPairgsq%realSpace(:) = fld(:,1)
    call grad_1d_wtype(tPairgsq, dk)
    grad(:) = tPairgsq%realSpace(:)

!    kinetic(:)   = 0.5_dl*(fld(:,2)**2._dl)
!    gradient(:)  = 0.5_dl*(grad(:)**2._dl)
!    potential(:) = 4._dl*nu * (-cos(fld(:,1)) + 0.5_dl*lambda**2._dl * sin(fld(:,1))**2._dl)

    inquire(file='/gpfs/dpirvu/velocity_comparison/b_supercrit_instanton_x'//trim(str(nLat))//'_phi0'//trim(real_str(phi0))//'_lambda'//trim(real_str(lambda))//'_fields.dat', opened=o)

    if (.not.o) then
       open(unit=oFile,file='/gpfs/dpirvu/velocity_comparison/b_supercrit_instanton_x'//trim(str(nLat))//'_phi0'//trim(real_str(phi0))//'_lambda'//trim(real_str(lambda))//'_fields.dat')
       write(oFile,*) "# Lattice Parameters dx = ", dx, "nLat = ", nLat, " lenLat = ", lenLat, "dk = ", dk
       write(oFile,*) "# Time Stepping parameters dt_out = ", dtout, " m2eff = ", m2eff, " phi0 = ", phi0, " temperature = ", temp
    endif

    do m = 1, nLat
       write(oFile,*) fld(m,:), grad(m)
    end do

  end subroutine output_fields

end program Gross_Pitaevskii_1d
